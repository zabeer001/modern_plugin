const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./InlineText-1.0.61-Dt46MBqf.js","./cm-1.0.61-D9ug3d5m.js","./redux-1.0.61-CrJ4jvTM.js","./vendor-1.0.61-CN03Eozo.js","./lib-1.0.61-DoXQcMHD.js","./loglevel-1.0.61-BZ7XahX3.js","./lodash-1.0.61-C8OpKhUs.js","./moment-1.0.61-C5S46NFB.js","./tab-1.0.61-B4c65fpQ.js","./TextField-1.0.61-DyvT2G_W.js","./Typography-1.0.61-Cg0Css-P.js","./ButtonBase-1.0.61-BqsrQx8o.js","./useEnhancedEffect-1.0.61-CX4-xj9Z.js","./Select-1.0.61-DmroHcG5.js","./Menu-1.0.61-D2OtRuzX.js","./ThemeProvider-1.0.61-4HOD8y6D.js","./index-1.0.61-B7tjLD84.js","./Modal-1.0.61-DVFPMIPt.js","./notistack-1.0.61-0awN6uG4.js","./iconBase-1.0.61-C8saXaJ2.js","./createSvgIcon-1.0.61-DDgmYdEo.js","./InlineTextarea-1.0.61-DiGXNibC.js","./InlineNumber-1.0.61-C_RP7_H1.js","./react-number-format.es-1.0.61-3K4hYgeH.js","./InlineDate-1.0.61-DwQwxkxl.js","./useLocaleDayJs-1.0.61-CHv6X9Zj.js","./Languages-1.0.61-BxgPwugF.js","./hooks-1.0.61-Bklk-gZu.js","./dayjs.min-1.0.61-21Xi_c_9.js","./useMobilePicker-1.0.61-Dvb2yEEp.js","./InputAdornment-1.0.61-23wkGu1k.js","./cjs-1.0.61-D_0erLfe.js","./getThemeProps-1.0.61-OfsHdeDz.js","./index-1.0.61-CRnugLvI.js","./visuallyHidden-1.0.61-Dan1xhjv.js","./DialogContent-1.0.61-Ws3r0VFj.js","./ListItem-1.0.61-t1ycs9HY.js","./Chip-1.0.61-C6TjQKDp.js","./AdapterDayjs-1.0.61-BqcEbIuB.js","./DatePicker-1.0.61-CDckGagl.js","./dateViewRenderers-1.0.61-7dkntk_V.js","./InlineDatetime-1.0.61-lx5iwahw.js","./DateTimePicker-1.0.61-B22uat3C.js","./Tabs-1.0.61-Bhozjonn.js","./timeViewRenderers-1.0.61-Cu86BQXJ.js","./MenuItem-1.0.61-Bmr1xWyp.js","./Divider-1.0.61-C8DX248W.js","./InlineTime-1.0.61-4DjyosE5.js","./TimePicker-1.0.61-CeYQPlC5.js","./InlineCheckbox-1.0.61-wp3gkbA6.js","./useAutoUpdate-1.0.61-D2RcRxoL.js","./FormControlLabel-1.0.61-Bu2IQ4da.js","./Checkbox-1.0.61-BlN5bjuH.js","./SwitchBase-1.0.61-C2xa6JFZ.js","./InlineEnum-1.0.61-Dem5z6yY.js","./EnumTypeEnum-1.0.61-Ws4BsaYD.js","./RadioGroup-1.0.61-BZHJMWN9.js","./Radio-1.0.61-BXMcBwcB.js","./InlineSet-1.0.61-D4_39atr.js","./InlineLookup-1.0.61-DlUXQoJy.js","./ActionsDml-1.0.61-DA32DqSB.js","./RestApi-1.0.61-DdTZ_pIc.js","./useMetadata-1.0.61-CVl9oDgw.js","./index-1.0.61-LP991tft.js","./Autocomplete-1.0.61-CP0PiliY.js","./Close-1.0.61-CiuKDfYz.js","./InlineDuration-1.0.61--IMUtiU2.js","./TableLookup-1.0.61-9TESwAFl.js","./SharedContainer-1.0.61-D5Lln0NA.js","./cmJson-1.0.61-BLURwXOE.js","./rehyperaw-1.0.61-AkovKNCK.js","./markdown-1.0.61-6nAzZWly.js","./Spinner-1.0.61-khi9zO7Q.js","./AdminTheme-1.0.61-D8bUxwpM.js","./useAppFunctions-1.0.61-EdKk0_Mu.js","./useStoreFormSettings-1.0.61-CgHnNhxx.js","./useRemoveAppFromStore-1.0.61-E72jey9_.js","./AppTheme-1.0.61-CGnMRNDC.js","./useChartSettings-1.0.61-BIp9UVZM.js","./useLocaleUd-1.0.61-DEEqF_bH.js","./useScreenSize-1.0.61-B4FX7-PC.js","./dompurify-1.0.61-DhD2mIk-.js","./useFormDetails-1.0.61-677sicqv.js","./DynamicModeEnum-1.0.61-BXuL5kgA.js","./StoreTypeEnum-1.0.61-Tot-ESpR.js","./FallbackSpinner-1.0.61-s3WTN65t.js","./main-1.0.61.js","./SharedContainer-1.0.61-CL-1K3JO.css","./ColumnFilters-1.0.61-Cpk3nBOK.js","./index.esm-1.0.61-Dhj7A6Yv.js","./Stack-1.0.61-CNGwl0k7.js","./Collapse-1.0.61-Cww0NnSm.js","./AlertTitle-1.0.61-hpo1u3Vv.js","./TableRow-1.0.61-70IJJfOz.js","./ConfirmDialog-1.0.61-BrxkBu_y.js","./ListItemIcon-1.0.61-P8epLVMP.js","./TableHead-1.0.61-urAqheBu.js","./Switch-1.0.61-CRYcdQMV.js","./Slider-1.0.61-BGScnB2M.js","./DetailPanel-1.0.61-DUZ3s5F2.js","./TableToolbarTop-1.0.61-QXYOp2lz.js","./TabPanel-1.0.61-BtYzUOMH.js","./index-1.0.61-Cpig8940.js","./jstoxml-1.0.61-B-nwTQWX.js","./jstoxml-1.0.61-DkGlThlH.js","./FileSaver.min-1.0.61-CuTNgRON.js","./Tooltip-1.0.61-De3BL3Jg.js","./Tooltip-1.0.61--D4jr2go.css","./SanitizeComponent-1.0.61-jz3CtJfW.js","./index-1.0.61-Cpc7oUnN.js","./tanstack-1.0.61-ncdkBwIj.js","./TableContainer-1.0.61-D_jKUjyE.js","./ActionsSettings-1.0.61-NFzvwy8a.js","./TargetEnum-1.0.61-CIW1jlU5.js","./ScopeEnum-1.0.61-B4DDvIDj.js","./settings-1.0.61-BN5quc55.js","./Link-1.0.61-BHBICLVE.js","./CardHeader-1.0.61-gDG-f_-J.js","./settings-1.0.61-DuwCupdk.css","./useTableUpdater-1.0.61-D-pqUshE.js","./useTableCode-1.0.61-BufK_zHB.js","./useTableColumnOrder-1.0.61-Ds81s_GP.js","./useLocaleMrt-1.0.61-C3Pa4C9e.js","./TableToolbarBottom-1.0.61-ClouYxPD.js","./RowActions-1.0.61-s7TazW6T.js"])))=>i.map(i=>d[i]);
import{_ as Y}from"./cmJson-1.0.61-BLURwXOE.js";import{j as p}from"./cm-1.0.61-D9ug3d5m.js";import{r as c}from"./redux-1.0.61-CrJ4jvTM.js";import{l as m,g as tn,c6 as Pt,c7 as Q,k as gt,c8 as Et,c9 as yt,ca as nn,bY as on,H as Le,cb as We,cc as rn,cd as ln,a2 as kt,Z as vt,r as Nt,at as Lt,bL as St,ce as ut,cf as Ot,am as jt,cg as sn,a as an,ch as et,ci as un,cj as cn,C as Mt,bi as dn,bj as mn,P as Bt,b as ct,a5 as pn,S as fn}from"./lib-1.0.61-DoXQcMHD.js";import{b as Gt,s as gn,c as hn,d as bn}from"./SharedContainer-1.0.61-D5Lln0NA.js";import{u as Oe,a as Ct}from"./hooks-1.0.61-Bklk-gZu.js";import{Q as Vt,a2 as Cn,e as yn}from"./index-1.0.61-B7tjLD84.js";import{T as Dt}from"./Tooltip-1.0.61-De3BL3Jg.js";import{S as Sn}from"./SanitizeComponent-1.0.61-jz3CtJfW.js";import{g as Qt,c as ht}from"./vendor-1.0.61-CN03Eozo.js";import{l as _n,m as wn,n as En,o as xn,p as Fn}from"./index-1.0.61-Cpc7oUnN.js";import{u as Xt}from"./useAppFunctions-1.0.61-EdKk0_Mu.js";import"./moment-1.0.61-C5S46NFB.js";import"./notistack-1.0.61-0awN6uG4.js";import{i as An}from"./index-1.0.61-LP991tft.js";import{u as Rn,k as Tn}from"./tanstack-1.0.61-ncdkBwIj.js";import{u as Pn,M as kn,a as vn,b as Nn}from"./index.esm-1.0.61-Dhj7A6Yv.js";import{a as Ln}from"./RestApi-1.0.61-DdTZ_pIc.js";import{c as zt,a as It,b as On,d as Ht,g as Wt}from"./tab-1.0.61-B4c65fpQ.js";import{a as jn}from"./useRemoveAppFromStore-1.0.61-E72jey9_.js";import{u as Mn}from"./TableContainer-1.0.61-D_jKUjyE.js";import{a as Bn,u as Vn}from"./useChartSettings-1.0.61-BIp9UVZM.js";import{l as Dn}from"./ActionsDml-1.0.61-DA32DqSB.js";import{u as zn}from"./useTableCode-1.0.61-BufK_zHB.js";import{u as In}from"./AppTheme-1.0.61-CGnMRNDC.js";import{u as Hn}from"./useTableColumnOrder-1.0.61-Ds81s_GP.js";import{u as Wn}from"./useLocaleMrt-1.0.61-C3Pa4C9e.js";import{B as Ut}from"./Spinner-1.0.61-khi9zO7Q.js";import{C as qt}from"./Checkbox-1.0.61-BlN5bjuH.js";import{T as Un}from"./Typography-1.0.61-Cg0Css-P.js";const qn=r=>{const s=Gt(r),d=c.useMemo(()=>[],[s.columns]);return m.debug("inlineEditingColumns",d),d},Yt=r=>{const s=Oe(d=>d.tables[r].columns);return m.debug("tableColumns",s),s.filter(d=>d.lookup!==void 0)},Zt=r=>{const s=Oe(d=>d.lookups[r]);return m.debug("lookups",s),s};var _t,$t;function $n(){if($t)return _t;$t=1;var r=function(w){return w instanceof RegExp},s=function(R){var T=/[\\^$.*+?()[\]{}|]/g,f=RegExp(T.source);return R&&f.test(R)?R.replace(T,"\\$&"):R},d=function(w){return typeof w=="string"},_=function(w){var R=[];return w.forEach(function(T){Array.isArray(T)?R=R.concat(T):R.push(T)}),R};function u(w,R,T){var f=0,i=0;if(w==="")return w;if(!w||!d(w))throw new TypeError("First argument to react-string-replace#replaceString must be a string");var y=R;r(y)||(y=new RegExp("("+s(y)+")","gi"));for(var g=w.split(y),Z=1,$=g.length;Z<$;Z+=2){if(g[Z]===void 0||g[Z-1]===void 0){console.warn("reactStringReplace: Encountered undefined value during string replacement. Your RegExp may not be working the way you expect.");continue}i=g[Z].length,f+=g[Z-1].length,g[Z]=T(g[Z],Z,f),f+=i}return g}return _t=function(R,T,f){return Array.isArray(R)||(R=[R]),_(R.map(function(i){return d(i)?u(i,T,f):i}))},_t}var Kn=$n();const Gn=Qt(Kn),Qn=r=>{const s=Oe(d=>{var _,u;return(u=(_=d.tables[r])==null?void 0:_.state)==null?void 0:u.data});return m.debug("storeRows",s),s};c.lazy(()=>Y(()=>import("./InlineText-1.0.61-Dt46MBqf.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),import.meta.url));c.lazy(()=>Y(()=>import("./InlineTextarea-1.0.61-DiGXNibC.js"),__vite__mapDeps([21,1,2,3,8,4,5,6,7,9,10,11,12,13,14,15,16,17,18,19,20]),import.meta.url));c.lazy(()=>Y(()=>import("./InlineNumber-1.0.61-C_RP7_H1.js"),__vite__mapDeps([22,1,2,3,23,18,4,5,6,7,8,9,10,11,12,13,14,15,16,17,19,20]),import.meta.url));c.lazy(()=>Y(()=>import("./InlineDate-1.0.61-DwQwxkxl.js"),__vite__mapDeps([24,1,2,3,18,8,4,5,6,7,25,26,27,28,29,30,31,10,11,12,32,13,14,15,16,17,19,20,33,9,34,35,36,37,38,39,40]),import.meta.url));c.lazy(()=>Y(()=>import("./InlineDatetime-1.0.61-lx5iwahw.js"),__vite__mapDeps([41,1,2,3,18,8,4,5,6,7,25,26,27,28,29,30,31,10,11,12,32,13,14,15,16,17,19,20,33,9,34,35,36,37,38,42,43,44,45,40,46]),import.meta.url));c.lazy(()=>Y(()=>import("./InlineTime-1.0.61-4DjyosE5.js"),__vite__mapDeps([47,1,2,3,18,8,4,5,6,7,25,26,27,28,29,30,31,10,11,12,32,13,14,15,16,17,19,20,33,9,34,35,36,37,38,48,44,45]),import.meta.url));c.lazy(()=>Y(()=>import("./InlineCheckbox-1.0.61-wp3gkbA6.js"),__vite__mapDeps([49,1,2,3,50,4,5,6,7,51,10,13,14,15,12,16,11,17,18,19,20,52,53]),import.meta.url));c.lazy(()=>Y(()=>import("./InlineEnum-1.0.61-Dem5z6yY.js"),__vite__mapDeps([54,1,2,3,4,5,6,7,50,13,10,14,15,12,16,11,17,18,19,20,45,55,56,57,53,51]),import.meta.url));c.lazy(()=>Y(()=>import("./InlineSet-1.0.61-D4_39atr.js"),__vite__mapDeps([58,1,2,3,50,4,5,6,7,13,10,14,15,12,16,11,17,18,19,20,45]),import.meta.url));c.lazy(()=>Y(()=>import("./InlineLookup-1.0.61-DlUXQoJy.js"),__vite__mapDeps([59,1,2,3,4,5,6,7,60,61,27,62,8,63,9,10,11,12,13,14,15,16,17,18,19,20,64,65,37]),import.meta.url));c.lazy(()=>Y(()=>import("./InlineDuration-1.0.61--IMUtiU2.js"),__vite__mapDeps([66,1,2,3,23,8,4,5,6,7,9,10,11,12,13,14,15,16,17,18,19,20]),import.meta.url));const Xn=c.lazy(()=>Y(()=>import("./TableLookup-1.0.61-9TESwAFl.js"),__vite__mapDeps([67,1,2,3,60,4,5,6,7,61,27]),import.meta.url));c.lazy(()=>Y(()=>import("./SharedContainer-1.0.61-D5Lln0NA.js").then(r=>r.D),__vite__mapDeps([68,69,1,2,3,4,5,6,7,70,71,27,72,10,73,60,61,18,74,62,75,76,26,77,33,32,12,78,79,80,31,11,63,28,16,15,17,19,81,82,83,84,85,86,87]),import.meta.url));const Yn=({appId:r,metaData:s,hasPrimaryKey:d,tableStore:_,appSettings:u,storeTheme:w,tableColumns:R,globalFilter:T,columnFilters:f,locale:i,appLanguage:y,lovs:g,data:Z,media:$,setCurrentFilterColumnName:re,getPrimaryKey:Fe,clientSideProcessing:Se,tableAggregations:je,setCssRowColor:x,setCssRowBgColor:Ue,setCssColumnColor:Be,setCssColumnBgColor:k})=>{var W,K,fe,Ce;const I=qn(r),J=Yt(r),O=Zt(r);Xt(r);const ee=Qn(r),ie=((K=(W=s==null?void 0:s.settings)==null?void 0:W.wp)==null?void 0:K.date_format)??"",j=((Ce=(fe=s==null?void 0:s.settings)==null?void 0:fe.wp)==null?void 0:Ce.time_format)??"",ue=E=>{if(g[E.columnName]!==void 0)return g[E.columnName].map(U=>U.value)},ce=E=>p.jsx(Sn,{html:E,css:{whiteSpace:"pre-wrap"}}),H=(w==null?void 0:w.mode)==="dark"?"rgb(183, 93, 0)":"rgb(255, 203, 127)";m.debug("matchHighlightColor",H);const _e=(E,U,F,l)=>{const v=p.jsx("span",{style:{backgroundColor:H,borderRadius:"2px",padding:"2px 1px"},children:E},F+(l??0));return U.allowMarkup===!0?gn.renderToString(v):v},tt=(E,U,F)=>{if(!_.table.searchSettings.highlightMatches)return E;let l=E;return(T==null?void 0:T.trim())!==""&&(l=Gn(l,T,(v,q)=>_e(v,U,F,q))),m.debug(U.columnName,E,l),l},qe=(E,U)=>{if(U===null)return"";if(E.allowMarkup){const F=Array.isArray(U)?U.join(""):U;return ce(E.prefix+F+E.suffix)}else return p.jsxs(p.Fragment,{children:[E.prefix,U,E.suffix]})},$e=(E,U,F,l)=>l,Ve=c.useMemo(()=>{var U;m.debug("executing memo columnDef");const E=[];for(let F=0;F<R.length;F++){const l=R[F],v=l.columnName,q=l.columnLabel,we=tn(s,l.columnName);let nt=l.lookup!==void 0?"string":we!==void 0?Pt(we.data_type):void 0,de=we!==void 0?Pt(we.data_type,!0):void 0,Ae=we!==void 0?we.data_type:void 0;const te=s.media[v];let ge=Se===!0&&l.inlineSearchEnum===Q.SEARCHBOX&&l.inlineSearchAutocomplete===!0,he=l.width;m.debug(v,q,de,Ae,te);const A={accessorKey:v,header:q,size:he,muiTableHeadCellProps:{className:l.classNames+" pp-table-column "+l.columnName+(l.computedField===void 0&&l.orderable?" pp-column-orderable":"")+(l.alignment===gt.LEFT?" pp-align-left":l.alignment===gt.RIGHT?" pp-align-right":""),align:l.alignment,sx:{maxWidth:`${he}px`}},muiTableBodyCellProps:{className:l.classNames+" pp-table-column "+l.columnName+(l.computedField===void 0&&l.orderable?" pp-column-orderable":"")+(l.alignment===gt.LEFT?" pp-align-left":l.alignment===gt.RIGHT?" pp-align-right":""),align:l.alignment},enableColumnFilter:l.inlineSearch&&!1,enableSorting:l.orderable,enableColumnActions:l.inlineSearch||l.orderable,columnFilterModeOptions:nt==="string"?["contains","startsWith","endsWith","equals","notEquals","empty","notEmpty"]:["contains","equals","notEquals","greaterThan","greaterThanOrEqualTo","lessThan","lessThanOrEqualTo","between","betweenInclusive","empty","notEmpty"],filterVariant:l.inlineSearch&&l.inlineSearchEnum===Q.DROPDOWN?"select":l.inlineSearch&&(l.inlineSearchEnum===Q.MULTISELECT||l.inlineSearchEnum===Q.SEARCHPANE)?"multi-select":ge&&l.lookup===void 0?"autocomplete":"text",...!Se&&{filterSelectOptions:l.inlineSearch&&l.inlineSearchEnum!==Q.SEARCHBOX&&g[l.columnName]!==void 0?ue(l):void 0},...Se&&{accessorFn:b=>{var N;return l.lookup&&l.lookup.loadOnStartup&&O&&O[v]&&O[v][b[v]]?Array.isArray(O[v][b[v]])?O[v][b[v]].join((N=l==null?void 0:l.lookup)==null?void 0:N.delimiter):O[v][b[v]]:l.inlineSearchShowEmpty?b[v]===""?`- ${i.filterEmpty} -`:b[v]??`- ${i.filterEmpty} -`:b[v]??void 0}},muiFilterTextFieldProps:({column:b})=>({autoComplete:"new-password",slotProps:{input:{autoComplete:"new-password"}},label:i.filterByColumn.replaceAll("{column}",b.columnDef.header),...(de==="date"||de==="datetime")&&{placeholder:"yyyy-mm-dd"},onFocus:()=>{re(l.columnName)},onBlur:()=>{re("")}})};if((l.lookup!==void 0||l.inlineSearchEnum!==Q.SEARCHBOX||ge)&&(A.enableColumnFilterModes=!1),_.table.showFooter&&(A.footer=q),l.computedField!==void 0){A.header=((U=l==null?void 0:l.computedField)==null?void 0:U.label)??"",A.enableSorting=!1,A.enableColumnActions=!1,A.Cell=({cell:b,row:N})=>{var V;m.debug(b,N);const L=ee[N.id]??N.original,B=nn(l.computedField,L,J,O);return B===null?null:((V=l.computedField)==null?void 0:V.type)===on.TEXT?qe(l,B):null},E.push(A);continue}if(l.lookup!==void 0){A.Cell=({cell:b,renderedCellValue:N})=>N===null||N===""?null:p.jsx(c.Suspense,{children:p.jsx(Xn,{appId:r,lookupColumn:l,cell:b,metaData:s,highlight:tt})}),E.push(A);continue}l.computedField===void 0&&(te==="ImageURL"?(A.muiTableBodyCellProps={className:"pp-image "+l.classNames,align:l.alignment,sx:{"& img":{maxWidth:"100%",height:"100%"}}},A.enableColumnFilter=!1,A.enableSorting=!1,A.enableColumnActions=!1,A.Cell=({cell:b,renderedCellValue:N})=>(m.debug(de,b),N===null||b.getValue()===null||b.getValue()===""?null:p.jsx(p.Fragment,{children:p.jsx("img",{src:b.getValue(),alt:l.columnLabel})}))):te==="HyperlinkURL"||te==="HyperlinkObject"?(A.muiTableBodyCellProps={className:"pp-hyperlink "+l.classNames,align:l.alignment},A.enableColumnFilter=!1,A.enableSorting=!1,A.enableColumnActions=!1,A.Cell=({cell:b,renderedCellValue:N})=>{if(m.debug(de,b),N===null||b.getValue()===null||b.getValue()==="")return null;if(te==="HyperlinkObject")try{const L=JSON.parse(b.getValue());return(L==null?void 0:L.url)!==""&&(L!=null&&L.target)&&(L==null?void 0:L.label)!==""?p.jsx("a",{href:L.url,target:L.target,onClick:B=>{B.stopPropagation()},children:L.label}):null}catch{return p.jsx(Dt,{title:"Invalid hyperlink",position:"right",children:p.jsx(Vt,{})})}else return p.jsxs("a",{href:b.getValue(),target:"_blank",style:{display:"flex",alignItems:"center",gap:"5px"},onClick:L=>{L.stopPropagation()},children:[p.jsx(Cn,{}),p.jsx("span",{children:l.columnLabel})]})}):te==="WP-Image"||te==="WP-Attachment"||te==="WP-Audio"||te==="WP-Video"?(A.muiTableBodyCellProps={className:te.toLowerCase()+" "+l.classNames,align:l.alignment},te==="WP-Image"&&(A.muiTableBodyCellProps.sx={"& img":{maxWidth:"100%",height:Et()?"auto":"100%"}}),A.enableColumnFilter=!1,A.enableSorting=!1,A.enableColumnActions=!1,A.Cell=({cell:b,row:N,renderedCellValue:L})=>(m.debug(de,b,N),L===null||b.getValue()===null||b.getValue()===""||$===void 0||!$[N.id]||!$[N.id][l.columnName]?null:p.jsxs(p.Fragment,{children:[...$[N.id][l.columnName].map(B=>{try{const V=JSON.parse(B);if(!(V!=null&&V.url))return null;switch(te){case"WP-Image":return p.jsx("img",{src:V.url,title:V.title,alt:V.title},V.title);case"WP-Audio":return p.jsx("audio",{controls:!0,children:p.jsx("source",{src:V.url,type:V.mime_type})});case"WP-Video":return p.jsx("video",{controls:!0,children:p.jsx("source",{src:V.url,type:V.mime_type})});default:{const Re=V.mime_type.split("/");return p.jsxs("a",{href:V.url,title:V.title,target:"_blank",onClick:Me=>{Me.stopPropagation()},children:[p.jsxs("div",{className:"pp-attachment-icon",children:[Re[0]==="image"&&p.jsx(_n,{}),Re[0]==="audio"&&p.jsx(wn,{}),Re[0]==="video"&&p.jsx(En,{}),Re[0]==="application"?Re[1]==="pdf"?p.jsx(xn,{}):p.jsx(Fn,{}):p.jsx(p.Fragment,{})]}),p.jsx("div",{className:"pp-attachment-link",children:V.title})]})}}}catch{return p.jsx(Dt,{title:"Invalid media",position:"right",children:p.jsx("span",{children:p.jsx(Vt,{})})})}})]}))):(Ae!=null&&Ae.includes("text")&&(A.muiTableBodyCellProps={className:l.classNames,align:l.alignment,sx:{whiteSpace:"pre-wrap"}}),A.Cell=({cell:b,renderedCellValue:N,row:L})=>{if(m.debug(de,b,N),N===null||b.getValue()===null||b.getValue()==="")return $e(l.columnName,L,null,null);if(R[F].allowMarkup)return ce(b.getValue());if(de==="date"){if(ie!==""){const B=new Date(Date.parse(b.getValue()+" 00:00:00"));if(B.toString().toLowerCase()!=="invalid date")return yt(ie,B)}}else if(de==="datetime"){if(ie!==""&&j!==""){const B=new Date(Date.parse(b.getValue()));if(B.toString().toLowerCase()!=="invalid date")return yt(ie+" "+j,B)}}else if(de==="time"&&j!==""){const B=new Date(new Date().toDateString()+" "+b.getValue());if(B.toString().toLowerCase()!=="invalid date")return yt(j,B)}return N}),E.push(A))}return E},[r,_.table,R,Z,$,ee,g,O,I]);return m.debug("columnDef",Ve),Ve},Zn=r=>{const s=Ct();return()=>{s(Le({appId:r,property:{requery:new Date().getTime()}}))}},Jn=r=>{const s=Oe(d=>d.tables[r].columns);return m.debug("tableColumns",s),s.reduce((d,_)=>({...d,[_.columnName]:_}),{})},bt=(r,s,d=100)=>{const _=c.useRef(!0);c.useEffect(()=>{_.current=!0;const u=window.setTimeout(()=>{_.current&&r()},d);return()=>{_.current=!1,clearTimeout(u)}},[...s,d])},eo=(r,s,d,_,u,w,R,T,f)=>{const i=d.table,y=Jn(r),[g,Z]=c.useState(0),[$,re]=c.useState(0),Fe=c.useMemo(()=>u.map(k=>[k.columnName,k.visible,k.visibleTablet,k.visibleMobile,k.inlineEditing,k.width].join(":")).join("|"),[u]),Se=c.useMemo(()=>parseFloat(getComputedStyle(document.documentElement).fontSize),[]),je=k=>k*Se,x=(k,I)=>{var ue,ce;if(s.refs.tableContainerRef.current===null||k===!1||i.design.overflow!==We.RESPONSIVE)return;m.debug("handle responsive column hiding...");const J=2*(s.getState().density==="spacious"?je(1.5):s.getState().density==="comfortable"?je(1):je(.5))+2,O=80;let ee=0,ie=0;const j=s.getAllColumns();for(let H=0;H<j.length;H++){const _e=y[j[H].id];_e!==void 0?(_e==null?void 0:_e.visible)===!0&&Be()?(ee+=j[H].getSize()+J,H>I&&ie>0&&ee+O>$?j[H].toggleVisibility(!1):(j[H].toggleVisibility(!0),ie++)):j[H].toggleVisibility(!1):(((ue=j[H])==null?void 0:ue.id)!=="mrt-row-select"||((ce=j[H])==null?void 0:ce.id)!=="mrt-row-expand")&&(ee+=j[H].getSize()+J)}},Ue=k=>{if(s.refs.tableContainerRef.current===null||k===!1||i.design.overflow!==We.SCROLL)return;m.debug("hide columns on mobiles and tablets..."),s.refs.tableContainerRef.current.offsetWidth;const I=s.getAllColumns();for(let J=0;J<I.length;J++){const O=y[I[J].id];O!==void 0&&((O==null?void 0:O.visible)===!0?I[J].toggleVisibility(Be()):I[J].toggleVisibility(!1))}},Be=(k,I)=>!0;bt(()=>{!_.current&&i.design.overflow===We.RESPONSIVE&&(m.debug("effect responsive column hiding..."),x(w,(T||f?1:0)+1))},[s.getState().density,i.design.overflow,Fe,w,i.searchSettings.searchForm,i.searchSettings.searchFormPosition,R],200),c.useEffect(()=>{let k=null,I;const J=()=>{var ee,ie;const O=(ie=(ee=s==null?void 0:s.refs)==null?void 0:ee.tableContainerRef)==null?void 0:ie.current;O?(k=new ResizeObserver(j=>{const ue=j[0].contentRect.width;re(ce=>ce!==ue?ue:ce)}),k&&k.observe(O)):I=requestAnimationFrame(J)};return J(),()=>{I&&cancelAnimationFrame(I),k==null||k.disconnect()}},[]),bt(()=>{!_.current&&Math.abs($-g)>rn()&&(m.debug("effect responsive column hiding (containerWidth)..."),x(w,(T||f?1:0)+1),Z($))},[$]),bt(()=>{!_.current&&i.design.overflow===We.SCROLL&&(m.debug("effect column hiding"),Ue(w))},[i.design.overflow])},to=r=>{const s=Oe(d=>{var _,u;return((u=(_=d.tables[r])==null?void 0:_.state)==null?void 0:u.isRowCountUpdated)??!1});return m.debug("isRowCountUpdated",s),s},no=r=>({getCssRowId:(s,d)=>"",setCssRowColor:(s,d,_)=>{},setCssRowBgColor:(s,d,_)=>{},getCssColumnId:(s,d,_)=>"",setCssColumnColor:(s,d,_,u)=>{},setCssColumnBgColor:(s,d,_,u)=>{}});var wt,Kt;function oo(){if(Kt)return wt;Kt=1;var r=200,s="__lodash_hash_undefined__",d=1/0,_=9007199254740991,u="[object Arguments]",w="[object Function]",R="[object GeneratorFunction]",T=/[\\^$.*+?()[\]{}|]/g,f=/^\[object .+?Constructor\]$/,i=typeof ht=="object"&&ht&&ht.Object===Object&&ht,y=typeof self=="object"&&self&&self.Object===Object&&self,g=i||y||Function("return this")();function Z(e,o,a){switch(a.length){case 0:return e.call(o);case 1:return e.call(o,a[0]);case 2:return e.call(o,a[0],a[1]);case 3:return e.call(o,a[0],a[1],a[2])}return e.apply(o,a)}function $(e,o){var a=e?e.length:0;return!!a&&Se(e,o,0)>-1}function re(e,o){for(var a=-1,S=o.length,G=e.length;++a<S;)e[G+a]=o[a];return e}function Fe(e,o,a,S){for(var G=e.length,le=a+-1;++le<G;)if(o(e[le],le,e))return le;return-1}function Se(e,o,a){if(o!==o)return Fe(e,je,a);for(var S=a-1,G=e.length;++S<G;)if(e[S]===o)return S;return-1}function je(e){return e!==e}function x(e,o){return e.has(o)}function Ue(e,o){return e==null?void 0:e[o]}function Be(e){var o=!1;if(e!=null&&typeof e.toString!="function")try{o=!!(e+"")}catch{}return o}function k(e){var o=-1,a=Array(e.size);return e.forEach(function(S){a[++o]=S}),a}var I=Array.prototype,J=Function.prototype,O=Object.prototype,ee=g["__core-js_shared__"],ie=function(){var e=/[^.]+$/.exec(ee&&ee.keys&&ee.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),j=J.toString,ue=O.hasOwnProperty,ce=O.toString,H=RegExp("^"+j.call(ue).replace(T,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_e=g.Symbol,tt=O.propertyIsEnumerable,qe=I.splice,$e=_e?_e.isConcatSpreadable:void 0,Ve=Math.max,W=it(g,"Map"),K=it(g,"Set"),fe=it(Object,"create");function Ce(e){var o=-1,a=e?e.length:0;for(this.clear();++o<a;){var S=e[o];this.set(S[0],S[1])}}function E(){this.__data__=fe?fe(null):{}}function U(e){return this.has(e)&&delete this.__data__[e]}function F(e){var o=this.__data__;if(fe){var a=o[e];return a===s?void 0:a}return ue.call(o,e)?o[e]:void 0}function l(e){var o=this.__data__;return fe?o[e]!==void 0:ue.call(o,e)}function v(e,o){var a=this.__data__;return a[e]=fe&&o===void 0?s:o,this}Ce.prototype.clear=E,Ce.prototype.delete=U,Ce.prototype.get=F,Ce.prototype.has=l,Ce.prototype.set=v;function q(e){var o=-1,a=e?e.length:0;for(this.clear();++o<a;){var S=e[o];this.set(S[0],S[1])}}function we(){this.__data__=[]}function nt(e){var o=this.__data__,a=Me(o,e);if(a<0)return!1;var S=o.length-1;return a==S?o.pop():qe.call(o,a,1),!0}function de(e){var o=this.__data__,a=Me(o,e);return a<0?void 0:o[a][1]}function Ae(e){return Me(this.__data__,e)>-1}function te(e,o){var a=this.__data__,S=Me(a,e);return S<0?a.push([e,o]):a[S][1]=o,this}q.prototype.clear=we,q.prototype.delete=nt,q.prototype.get=de,q.prototype.has=Ae,q.prototype.set=te;function ge(e){var o=-1,a=e?e.length:0;for(this.clear();++o<a;){var S=e[o];this.set(S[0],S[1])}}function he(){this.__data__={hash:new Ce,map:new(W||q),string:new Ce}}function A(e){return ne(this,e).delete(e)}function b(e){return ne(this,e).get(e)}function N(e){return ne(this,e).has(e)}function L(e,o){return ne(this,e).set(e,o),this}ge.prototype.clear=he,ge.prototype.delete=A,ge.prototype.get=b,ge.prototype.has=N,ge.prototype.set=L;function B(e){var o=-1,a=e?e.length:0;for(this.__data__=new ge;++o<a;)this.add(e[o])}function V(e){return this.__data__.set(e,s),this}function Re(e){return this.__data__.has(e)}B.prototype.add=B.prototype.push=V,B.prototype.has=Re;function Me(e,o){for(var a=e.length;a--;)if(He(e[a][0],o))return a;return-1}function be(e,o,a,S,G){var le=-1,Te=e.length;for(a||(a=ze),G||(G=[]);++le<Te;){var me=e[le];a(me)&&re(G,me)}return G}function ot(e){if(!at(e)||Ge(e))return!1;var o=Xe(e)||Be(e)?H:f;return o.test(Qe(e))}function rt(e,o){return o=Ve(o===void 0?e.length-1:o,0),function(){for(var a=arguments,S=-1,G=Ve(a.length-o,0),le=Array(G);++S<G;)le[S]=a[o+S];S=-1;for(var Te=Array(o+1);++S<o;)Te[S]=a[S];return Te[o]=le,Z(e,this,Te)}}function dt(e,o,a){var S=-1,G=$,le=e.length,Te=!0,me=[],Pe=me;if(le>=r){var oe=De(e);if(oe)return k(oe);Te=!1,G=x,Pe=new B}else Pe=me;e:for(;++S<le;){var Ee=e[S],se=Ee;if(Ee=Ee!==0?Ee:0,Te&&se===se){for(var ke=Pe.length;ke--;)if(Pe[ke]===se)continue e;me.push(Ee)}else G(Pe,se,a)||(Pe!==me&&Pe.push(se),me.push(Ee))}return me}var De=K&&1/k(new K([,-0]))[1]==d?function(e){return new K(e)}:ft;function ne(e,o){var a=e.__data__;return Ke(o)?a[typeof o=="string"?"string":"hash"]:a.map}function it(e,o){var a=Ue(e,o);return ot(a)?a:void 0}function ze(e){return mt(e)||ye(e)||!!($e&&e&&e[$e])}function Ke(e){var o=typeof e;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?e!=="__proto__":e===null}function Ge(e){return!!ie&&ie in e}function Qe(e){if(e!=null){try{return j.call(e)}catch{}try{return e+""}catch{}}return""}var Ie=rt(function(e){return dt(be(e,1,st))});function He(e,o){return e===o||e!==e&&o!==o}function ye(e){return st(e)&&ue.call(e,"callee")&&(!tt.call(e,"callee")||ce.call(e)==u)}var mt=Array.isArray;function lt(e){return e!=null&&Ye(e.length)&&!Xe(e)}function st(e){return pt(e)&&lt(e)}function Xe(e){var o=at(e)?ce.call(e):"";return o==w||o==R}function Ye(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=_}function at(e){var o=typeof e;return!!e&&(o=="object"||o=="function")}function pt(e){return!!e&&typeof e=="object"}function ft(){}return wt=Ie,wt}var ro=oo();const io=Qt(ro),lo=r=>{const s=Oe(d=>{var _,u;return((u=(_=d.tables[r])==null?void 0:_.state)==null?void 0:u.showColumnFilters)??!1});return m.debug("showColumnFilters",s),s},so=r=>{const s=Oe(d=>d.lovs[r]);return m.debug("lovs",s),s},ao=r=>{const s=Oe(d=>d.tables[r].columns);return m.debug("tableColumns",s),s.filter(d=>d.inlineSearch===!0)},uo=r=>[],co=(r,s)=>{if(!s)return!1;const d=Oe(_=>{var u,w;return(w=(u=_.tables[r])==null?void 0:u.state)==null?void 0:w.deleteColumnFilter});return m.debug("deleteColumnFilter",d),d},mo=()=>{const r=Ct();return(d,_)=>{const u=_.getRowModel().rows.map(w=>w.original);m.debug("update map data",u),Array.isArray(u)?r(Le({appId:d,property:{mapData:u}})):r(Le({appId:d,property:{mapData:void 0}}))}},po=r=>{const s=Ct(),d=Bn(r);return{chartSettings:d,updateChartData:(u,w,R)=>{if(d===void 0)return;m.debug("update chart data");const T=w.columns,f=ln(u,d==null?void 0:d.majorAxisColumn,d==null?void 0:d.minorAxisColumns,d==null?void 0:d.grouped,T,R);m.debug(f),Array.isArray(f)?s(kt({appId:r,property:{data:f}})):s(kt({appId:r,property:{data:[]}}))}}};c.lazy(()=>Y(()=>import("./ColumnFilters-1.0.61-Cpk3nBOK.js"),__vite__mapDeps([88,69,1,2,3,4,5,6,7,70,71,89,20,10,18,33,32,12,11,90,30,31,13,14,15,16,17,19,72,57,53,52,37,91,92,65,9,45,93,35,94,73,95,96,46,51,97,64,98,34,48,29,36,44,42,43,40,39,81]),import.meta.url));const fo=c.lazy(()=>Y(()=>import("./DetailPanel-1.0.61-DUZ3s5F2.js"),__vite__mapDeps([99,1,2,3,68,69,4,5,6,7,70,71,27,72,10,73,60,61,18,74,62,75,76,26,77,33,32,12,78,79,80,31,11,63,28,16,15,17,19,81,82,83,84,85,86,87,89,20,90,30,13,14,57,53,52,37,91,92,65,9,45,93,35,94,95,96,46,51,97,64,98,34,48,29,36,44,42,43,40,39,8]),import.meta.url)),go=c.lazy(()=>Y(()=>import("./TableToolbarTop-1.0.61-QXYOp2lz.js"),__vite__mapDeps([100,69,1,2,3,4,5,6,7,70,71,16,10,11,12,15,17,18,19,101,30,31,32,13,14,20,102,103,104,105,81,60,61,94,73,35,27,76,26,77,33,68,72,74,62,75,78,79,80,63,28,82,83,84,85,86,87,9,64,65,37,51,52,53,56,57,106,107,108,109,110,89,90,91,92,45,93,95,96,46,97,98,34,48,29,36,44,42,43,40,39,8,111,112,113,114,115,116,117,118,119,120,121,122]),import.meta.url)),ho=c.lazy(()=>Y(()=>import("./TableToolbarBottom-1.0.61-ClouYxPD.js"),__vite__mapDeps([123,69,1,2,3,4,5,6,7,70,71,27,16,10,11,12,15,17,18,19,72,31]),import.meta.url)),bo=c.lazy(()=>Y(()=>import("./RowActions-1.0.61-s7TazW6T.js"),__vite__mapDeps([124,1,2,3,16,10,4,5,6,7,11,12,15,17,18,19,27,68,69,70,71,72,73,60,61,74,62,75,76,26,77,33,32,78,79,80,31,63,28,81,82,83,84,85,86,87,94,35,52,53,13,14,20]),import.meta.url)),Co=({appId:r,display:s,refresh:d,showForm:_,metaData:u})=>{var At,Rt,Tt;const w=Ct(),R=c.useRef(null),T=c.useRef(!0),f=Gt(r),i=f.table,y=f.columns,g=f.state,Z=bn(),$=Vn(r),re=jn(r),Fe=zn(),Se=uo(),je=hn(r),x=In(),Ue=Hn(r),Be=ao(r),k=Yt(r),I=Zt(r),J=Mn(r),O=to(r),ee=Zn(r),ie=mo(),{chartSettings:j,updateChartData:ue}=po(r),{app:ce}=Xt(r),{getCssRowId:H,setCssRowColor:_e,setCssRowBgColor:tt,getCssColumnId:qe,setCssColumnColor:$e,setCssColumnBgColor:Ve}=no(),[W]=c.useState(i.clientSideProcessing),[K]=c.useState(!i.clientSideProcessing&&i.largeTableSupport);m.debug(K,W);const[fe,Ce]=c.useState([]),[E,U]=c.useState(""),[F,l]=c.useState([]),v=lo(r),[q,we]=c.useState(!1),[nt,de]=c.useState(!1),[Ae,te]=c.useState("");m.debug(F,q);const ge=co(r,vt(u));c.useEffect(()=>{if(ge!==void 0){m.debug("effect delete column filter");const t=[];F.map(n=>{n.id!==ge&&t.push(n)}),l(t),w(Le({appId:r,property:{deleteColumnFilter:void 0}}))}},[ge]);const[he,A]=c.useState(void 0),[b,N]=c.useState(Nt({global:E,column:[...F],columnFns:{}})),L=c.useMemo(()=>y.map(t=>[t.columnName,JSON.stringify(t.lookup),t.inlineSearch,t.inlineSearchEnum].join(":")).join("|"),[y]),[B,V]=c.useState({});m.debug(r,s,d,u,fe,E,he,b,B);const[Re,Me]=c.useState("");m.debug(Re);const[be,ot]=c.useState({pageIndex:0,pageSize:Number(((At=i==null?void 0:i.pagination)==null?void 0:At.defaultPageSize)??10)});m.debug(be);const[rt,dt]=c.useState(void 0),De=()=>{setTimeout(()=>{we(!q)},500)},{mrtLocale:ne,mrtIsLoading:it}=Wn(re.language.code,re==null?void 0:re.translation),ze=u.primary_key.length>0,Ke=i.viewLink,Ge=!Lt(u)&&ze&&((Rt=u==null?void 0:u.privs)==null?void 0:Rt.update)&&i.transactions.update&&f.state.permissions.update!==!1,Qe=!Lt(u)&&ze&&((Tt=u==null?void 0:u.privs)==null?void 0:Tt.delete)&&i.transactions.delete&&f.state.permissions.delete!==!1,Ie=Ke||Ge||Qe,He=i.bulkActions,ye=c.useMemo(()=>{var n,h;let t=!1;for(const C in He)((n=f.state.permissions.bulkActions)==null?void 0:n[C])!==!1&&(C==="pdf"||C==="excel"||St(r)&&C==="sql"||(!((h=u==null?void 0:u.privs)!=null&&h.delete)||!ze)&&C==="delete"||(t=t||He[C]===!0));return t},[He,f.state.permissions.bulkActions]);m.debug(f,ze,Ke,Ge,Qe,Ie,He,ye);const mt=c.useMemo(()=>g.relTab!==!0&&g.masterDetailConditions!==void 0&&vt(u),[g.relTab,g.masterDetailConditions]),lt=c.useMemo(()=>({}),[y]);m.debug("inlineSearchColumns",lt);const st=()=>y.filter(t=>t.lookup!==void 0).map(t=>t.columnName),Xe=()=>{var t;for(let n=0;n<y.length;n++){const h=y[n].lookup;if(h!==void 0&&(h.loadOnStartup||y[n].inlineEditing&&((t=f.state.permissions.inlineEditing)==null?void 0:t[y[n].columnName])!==!1)&&Re!==y[n].columnName){const C=f.table.searchSettings.cascade===!0,M=I!==void 0&&I[y[n].columnName]!==void 0;if(!M||g.reloadLookupList.includes(y[n].columnName)||C===!0&&y[n].inlineSearchEnum!==Q.SEARCHBOX){const D={};C===!0&&(D.cols=at(),D.search=E,D.search_columns=pt(),D.search_column_fns=e(),D.search_column_lov=st(),D.search_data_types=Ht(y,u),D.search_custom=Wt(f.table.defaultWhere),D.search_params=g.staticFilter,D.shortcode_params=g.shortcodeArgs,D.md=g.masterDetailConditions,D.cascade=C);const Ne=u.isRelationSelectionTable===!0?an.relationTablePrefix+y[n].columnName:y[n].columnName;Dn(r,"table",Ne,h.key,h.value,{},D,P=>{if(m.debug(P),(P==null?void 0:P.code)==="ok"){const ve={};for(let xe=0;xe<P.data.length;xe++)if(!h.value.includes(","))ve[P.data[xe].key]=P.data[xe].value;else{const pe=h.value.split(",");ve[P.data[xe].key]=pe.map(z=>P.data[xe][z])}(C!==!0||!M)&&w(un({appId:r,columnName:y[n].columnName,lookup:ve}))}else console.error(P==null?void 0:P.message)},P=>{console.error(P)})}}}},Ye=so(r)??{};c.useEffect(()=>{m.debug("effect lookups and lovs"),Xe()},[L]),c.useEffect(()=>{(g==null?void 0:g.reloadLookups)!==void 0&&(m.debug("effect update lookups"),Xe())},[g==null?void 0:g.reloadLookups]),c.useEffect(()=>{if(!T.current&&(m.debug("effect column filters"),K.actual===ut.ENABLED)){for(let t=0;t<y.length;t++)if(y[t].inlineSearch&&y[t].inlineSearchEnum!==Q.SEARCHBOX){const n=y[t].columnName;let h,C;for(let M=0;M<b.column.length;M++)b.column[M].id===n&&(h=b.column[M].value);for(let M=0;M<F.length;M++)F[M].id===n&&(C=F[M].value);h!==C&&we(!q)}}},[F]);const at=()=>{const t={};return y.filter(n=>n.computedField===void 0).map(n=>{t[n.columnName]=n.queryable}),t},pt=()=>F.map(t=>{var n,h;if(Array.isArray(t.value)&&t.value.length===0)return null;if(lt[t.id].inlineSearchEnum!==Q.SEARCHBOX&&((n=lt[t.id].lookup)==null?void 0:n.loadOnStartup)===!0&&Ye!==void 0&&Ye[t.id]!==void 0&&I!==void 0&&I[t.id]!==void 0){const C=Ye[t.id];if(C!==void 0)if(Array.isArray(t.value)){if(C.length>0)return{id:t.id,value:t.value.map(M=>{var D;return(D=C.find(Ne=>Ne.value===M))==null?void 0:D.key})}}else return{id:t.id,value:(h=C.find(M=>M.value===t.value))==null?void 0:h.key}}return t}),ft=()=>{const t={};return y.map(n=>{W&&(n.inlineSearchEnum===Q.MULTISELECT&&n.lookup&&n.lookup.loadOnStartup||n.inlineSearchEnum===Q.SEARCHPANE&&n.lookup&&n.lookup.loadOnStartup||n.inlineSearchEnum===Q.DROPDOWN&&n.lookup&&n.lookup.loadOnStartup||n.inlineSearchEnum===Q.SEARCHBOX&&n.lookup&&!n.lookup.loadOnStartup)?t[n.columnName]="lookupFilter":W&&(n.inlineSearchEnum===Q.MULTISELECT||n.inlineSearchEnum===Q.SEARCHPANE)?t[n.columnName]="arrIncludesSome":n.inlineSearchEnum!==Q.SEARCHBOX?t[n.columnName]="equals":t[n.columnName]="contains"}),t},e=()=>{const t=X.getState().columnFilterFns;return Object.keys(t).length>0?t:ft()},[o,a]=c.useState(ft());m.debug("columnFilterFns",o),c.useEffect(()=>{m.debug("effect set column filter fns"),a(e())},[y]);const{data:S,isError:G,isRefetching:le,isLoading:Te,refetch:me}=Rn({queryKey:["table-data",...W?[]:[be.pageIndex,be.pageSize,fe,q,K.actual===ut.ENABLED?q:E,K.actual===ut.ENABLED?q:F]],queryFn:async()=>{var n,h,C,M,D,Ne,P,ve,xe;let t;if(i.searchSettings.forceSearch&&Array.isArray(F)&&F.length===0&&(E===void 0||E===""))t={data:{code:"ok",data:{},meta:{rowCount:0}}};else{const pe=!An(b,{global:E,column:F,columnFns:X.getState().columnFilterFns});pe&&ot({pageIndex:It(),pageSize:be.pageSize});let z;K.saved===jt.ENABLED&&K.skipCount===!0?he===void 0?(z=cn(u),z===null&&(z=void 0)):z=he:(z=pe||O?void 0:he,w(Le({appId:r,property:{isRowCountUpdated:!1}}))),m.debug("metaRowCount",z),m.debug("rowCount",he);const ae={col:at(),page_index:be.pageIndex,page_size:be.pageSize,sorting:fe,search:E,search_columns:pt(),search_column_fns:e(),search_column_lov:st(),search_data_types:Ht(y,u),row_count:z,row_count_estimate:K.actual===ut.ENABLED,media:u==null?void 0:u.media,client_side:W};ae.search_custom=Wt(f.table.defaultWhere),ae.search_params=g.staticFilter,ae.shortcode_params=g.shortcodeArgs,g.masterDetailConditions!==void 0&&(ae.md=g.masterDetailConditions),m.debug(ae,u.src),g.relTab===!0&&(ae.rel_tab=!0),await Ln(u.src.app_id?Mt.appUrlAppSelect:Mt.appUrlSelect,{...ae,...u.src}).then(Je=>{t=Je,de(!0)}).catch(Je=>{console.error(Je),t={}})}return m.debug(t),A(W===!0?(h=(n=t==null?void 0:t.data)==null?void 0:n.data)==null?void 0:h.length:(M=(C=t==null?void 0:t.data)==null?void 0:C.meta)==null?void 0:M.rowCount),N(Nt({global:E,column:[...F],columnFns:{...X.getState().columnFilterFns}})),V((Ne=(D=t.data)==null?void 0:D.context)==null?void 0:Ne.media),m.debug(t.data),((P=t.data)==null?void 0:P.code)==="error"&&((ve=t.data)==null?void 0:ve.message)!==void 0?(te(t.data.message),console.error(t.data.message)):te(""),((xe=Fe==null?void 0:Fe.postQuery)==null?void 0:xe.enabled)===!0&&dn(Fe.postQuery.code??"",mn(u),!1,{table:{instance:X,state:f,requery:ee},app:ce}),St(r)&&!i.clientSideProcessing&&dt(!(rt??!1)),m.debug("json data",t.data),t.data},placeholderData:Tn}),Pe=Yn({appId:r,metaData:u,hasPrimaryKey:ze,tableStore:f,appSettings:re,storeTheme:x,tableColumns:y,globalFilter:E,columnFilters:F,locale:ne,appLanguage:$,lovs:Ye,data:S,media:B,setCurrentFilterColumnName:Me,getPrimaryKey:et,clientSideProcessing:W,tableAggregations:Se,setCssRowColor:_e,setCssRowBgColor:tt,setCssColumnColor:$e,setCssColumnBgColor:Ve});m.debug("columnDef",Pe);const[oe,Ee]=c.useState({});m.debug("rowSelection",oe);const se=()=>{var t;return((t=R==null?void 0:R.current)==null?void 0:t.offsetWidth)??0},ke=()=>{var t;return((t=X.refs.tableContainerRef.current)==null?void 0:t.offsetWidth)??0},Jt=["mrt-row-actions"].concat(Ue),xt=!1,en=(t,n,h)=>{var M,D,Ne;const C=fn.getState().lookups[r];if(C&&C[n]){const P=y.filter(z=>z.columnName===n)[0],ve=((M=t.getValue(n))==null?void 0:M.toString())??"",xe=t.original[n]??"";let pe=[];if(Array.isArray(h)){if(h.length===0){const z=[];F.map(ae=>{ae.id!==n&&z.push(ae)}),l(z)}else ve===`- ${ne.filterEmpty} -`&&h.includes(`- ${ne.filterEmpty} -`)?pe.push(`- ${ne.filterEmpty} -`):(pe=Object.values(C[n]).filter(z=>{var Je;const ae=Array.isArray(z)?z.join((Je=P==null?void 0:P.lookup)==null?void 0:Je.delimiter):z;return h.includes(ae)}),pe=(D=P==null?void 0:P.lookup)!=null&&D.value.includes(",")?pe.map(z=>{var ae;return z.join((ae=P==null?void 0:P.lookup)==null?void 0:ae.delimiter)}):pe);return pe.includes(ve)}else return P.inlineSearchEnum===Q.DROPDOWN?pe=h:pe=Object.keys(C[n]).filter(z=>{if(C[n][z].toString().toLowerCase().includes(h.toString().toLowerCase().trim()))return z}),pe.includes(((Ne=P.lookup)==null?void 0:Ne.loadOnStartup)===!0?ve:xe)}return!1},Ft=()=>{const t=X.getCoreRowModel(),n=Object.keys(oe).filter(C=>oe[C]===!0).length===t.rows.length,h={...oe};t.rows.map(C=>{h[C.index]=!n}),Ee(h)},Ze=c.useMemo(()=>{const t=i.design.density,n=Number(Ke)+Number(Ge)+Number(Qe),h=n*(x.fontSize?x.fontSize+22:40)+(n===1?(t.current===Ot.COMPACT?8:t.current===Ot.COMFORTABLE?16:24)+10:0),C=ye?x.fontSize?x.fontSize+22:40:0;return h+C},[i.design.density,Ke,Ge,Qe,x.fontSize,ye]),X=Pn({columns:Pe,data:(S==null?void 0:S.data)??[],...!W&&{rowCount:he??0},initialState:{density:i.design.density.default,columnPinning:{left:["mrt-row-actions"],right:["mrt-row-expand"]},...xt,expanded:(i==null?void 0:i.detailExpandAll)??void 0},state:{pagination:be,sorting:fe,globalFilter:E,columnFilters:F,isLoading:Te,showAlertBanner:G,showProgressBars:le,showColumnFilters:v,columnFilterFns:o,rowSelection:oe,columnOrder:Jt},localization:ne,enableStickyHeader:i.showHeader&&i.stickyHeader,enableStickyFooter:i.showFooter&&i.stickyFooter,enableColumnOrdering:xt,enableColumnResizing:!1,enableColumnPinning:i.design.overflow===We.SCROLL,enableHiding:!0,layoutMode:"semantic",enableTopToolbar:!0,enableBottomToolbar:!0,enableFullScreenToggle:!1,positionToolbarDropZone:"none",renderTopToolbarCustomActions:()=>p.jsx(c.Suspense,{children:p.jsx(go,{table:X,metaData:u,appId:r,bulkActions:He,hasBulkActions:ye,tableStore:f,appLanguage:$,locale:ne,refetch:me,showForm:(t,n)=>_(t,n),appSettings:re,componentWidth:ke(),toggleAllRows:Ft,globalFilter:E,columnFilters:F,pagination:be,rowCount:W?X.getFilteredRowModel().rows.length:he,largeTableSupport:K,aggr_tableAggregations:Se,aggr_data:S,aggr_lookupColumns:k,aggr_lookups:I,aggr_tableColumns:y})}),renderToolbarInternalActions:({table:t})=>p.jsxs(p.Fragment,{children:[i.searchSettings.enableGlobalSearch&&f.state.permissions.globalSearch!==!1&&p.jsx(vn,{table:t,"data-testid":"pp-global-search-icon"}),!1,!1,i.design.density.userCanChange&&p.jsx(Nn,{table:t,"data-testid":"pp-density-icon"})]}),muiTopToolbarProps:()=>({className:"pp-top-toolbar"}),muiToolbarAlertBannerProps:G?{color:"error",children:$.errorLoadingData}:void 0,enableRowActions:Ie||ye,positionActionsColumn:"first",renderRowActions:({row:t,table:n,staticRowIndex:h})=>p.jsx(c.Suspense,{children:p.jsx(bo,{metaData:u,appId:r,showForm:(C,M,D)=>_(C,M,n,D),rowData:t.original,storeTableSettings:i,refetch:me,locale:ne,appLanguage:$,rowIndex:h,rowSelected:oe[t.index]??!1,hasBulkActions:ye,table:n,tableStore:f,requery:ee,getComponentWidth:se})}),renderEmptyRowsFallback:()=>p.jsx(Un,{variant:"body1",component:"p",sx:{margin:"2rem",textAlign:"center",width:"100%",fontStyle:"italic"},color:Ae!==""?"error":"inherit",children:Ae===""?ne.noRecordsToDisplay:Ae}),displayColumnDefOptions:{"mrt-row-actions":{Header:({table:t})=>p.jsxs(Ut,{sx:{position:"relative"},children:[ye&&p.jsxs(p.Fragment,{children:[p.jsx(yn,{title:ne.toggleSelectAll,children:p.jsx(qt,{className:"pp-table-row-selection-checkbox",size:se()<500?"small":"medium",checked:Object.keys(oe).filter(n=>oe[n]===!0).length===t.getRowModel().rows.length,indeterminate:Object.keys(oe).filter(n=>oe[n]===!0).length!==0&&Object.keys(oe).filter(n=>oe[n]===!0).length!==t.getRowModel().rows.length,onClick:n=>{Ft(),n.preventDefault(),n.stopPropagation()}})}),p.jsx(qt,{className:"pp-table-row-selection-checkbox-value"})]}),Ie&&p.jsx("span",{children:ne.actions})]}),enableHiding:!1,muiTableHeadCellProps:{className:"pp-table-column-actions"+(se()<500?" pp-table-column-actions-mobile":""),sx:{minWidth:`${Ze}px`,width:`${Ze}px`,maxWidth:`${Ze}px`}},muiTableBodyCellProps:{className:"pp-table-column-actions"+(se()<500?" pp-table-column-actions-mobile":""),sx:{minWidth:`${Ze}px`,width:`${Ze}px`,maxWidth:`${Ze}px`}}},"mrt-row-expand":{minSize:24,size:24,maxSize:24,enableHiding:!1,muiTableHeadCellProps:{className:"pp-table-column-expand"+(se()<500?" pp-table-column-expand-mobile":""),sx:{...se()<500&&{width:"10%"}}},muiTableBodyCellProps:{className:"pp-table-column-expand"+(se()<500?" pp-table-column-expand-mobile":""),sx:{...se()<500&&{width:"10%"}}}}},renderColumnActionsMenuItems:({internalColumnMenuItems:t})=>{const n=t.filter(h=>h.key!=="3"&&h.key!=="5"&&h.key!=="11"&&h.key!=="12");return n.length===0?n:[...n.slice(0,n.length-1),pn({},...n.slice(n.length-1,n.length),{props:{divider:!1}})]},positionExpandColumn:"last",renderDetailPanel:sn(i)?t=>p.jsx(c.Suspense,{children:p.jsx(fo,{appId:r,table:t.table,row:t.row,columns:y,appSettings:re,metaData:u,tableSettings:i,data:S})}):void 0,onRowSelectionChange:ye?Ee:void 0,muiTableBodyRowProps:({row:t})=>({hover:!0,onClick:n=>{ye&&n.target.tagName.toUpperCase()==="INPUT"&&n.target.className.includes("pp-row-selection-checkbox")&&Ee(h=>({...h,[t.id]:!h[t.id]}))},selected:oe[t.id],sx:{color:()=>g.rowColor[H(t.id,et(u,t.original))]!==void 0?g.rowColor[H(t.id,et(u,t.original))]:(x==null?void 0:x.color)[x.shade],backgroundColor:g.rowBgColor[H(t.id,et(u,t.original))]??(t.index%2?(x==null?void 0:x.mode)===ct.DARK?"#202020":"#f9f9f9":(x==null?void 0:x.mode)===ct.DARK?"#1d1d1d":"#ffffff"),"&.MuiTableRow-hover:hover":{backgroundColor:(x==null?void 0:x.mode)===ct.DARK?"#1a1a1a":"#fefefe"},"&.Mui-selected":{backgroundColor:t.index%2?(x==null?void 0:x.mode)===ct.DARK?"#2a2a2a":"#eeeeee":(x==null?void 0:x.mode)===ct.DARK?"#1a1a1a":"#fefefe"}}}),muiTableBodyCellProps:t=>({sx:{color:()=>{const n=g.columnColor[qe(t.row.id,et(u,t.row.original),t.cell.column.id)];return n||"inherit"},backgroundColor:g.columnBgColor[qe(t.row.id,et(u,t.row.original),t.cell.column.id)]}}),enablePagination:!0,manualPagination:!W,onPaginationChange:t=>{Ee({}),(i==null?void 0:i.detailExpandAll)!==!0&&X.setExpanded({}),ot(t),St(r)&&i.clientSideProcessing&&dt(!(rt??!1))},paginationDisplayMode:K.actual===ut.ENABLED||i.pagination.showCompactButtons?"default":"pages",positionPagination:i.pagination.position,muiPaginationProps:{rowsPerPageOptions:io(i.pagination.rowsPerPage,[be.pageSize]),color:"primary",shape:"rounded",variant:"outlined",showRowsPerPage:!0,showFirstButton:i.pagination.showFirstButton,showLastButton:i.pagination.showLastButton&&!(K.saved===jt.ENABLED&&K.skipCount===!0)},manualFiltering:!W,enableGlobalFilter:i.searchSettings.enableGlobalSearch&&f.state.permissions.globalSearch!==!1,enableFilterMatchHighlighting:i.searchSettings.highlightMatches,onGlobalFilterChange:U,enableGlobalFilterModes:!1,globalFilterFn:"contains",enableColumnFilterModes:!0,columnFilterDisplayMode:zt(f)?"subheader":"custom",onColumnFilterFnsChange:a,onColumnFiltersChange:l,enableColumnFilters:Be.length>0&&(!J||!zt(f)),enableFacetedValues:!!W,filterFns:{lookupFilter:(t,n,h)=>en(t,n,h)},onShowColumnFiltersChange:()=>{i.searchSettings.searchFormAlwaysOpen||w(Le({appId:r,property:{showColumnFilters:!v}}))},muiSearchTextFieldProps:()=>({className:"pp-global-search-field",onKeyUp:t=>{t.key.toLowerCase()==="enter"&&De()},onClick:t=>{(t.target.tagName.toUpperCase()==="BUTTON"||t.target.parentElement.dataset.testid==="CloseIcon"||t.target.dataset.testid==="CloseIcon")&&De()}}),muiFilterTextFieldProps:({column:t})=>({className:"pp-column-search-field",id:"pp-column-search-field-"+t.columnDef.id,autoComplete:"new-password",slotProps:{input:{autoComplete:"new-password",placeholder:"new-password"}},onKeyUp:n=>{n.key.toLowerCase()==="enter"&&De()},onClickCapture:n=>{const h=y.filter(C=>C.columnName===t.id);if(h.length===1&&(h[0].inlineSearchEnum===Q.DROPDOWN||h[0].inlineSearchEnum===Q.MULTISELECT)&&n.target.tagName!=="svg"&&n.target.tagName!=="path"){const C=document.getElementById(`pp-column-search-field-${t.columnDef.id}`);C!==null&&(C.focus(),C.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",code:"Enter",keyCode:13,which:13,bubbles:!0})))}(n.target.tagName.toUpperCase()==="BUTTON"||n.target.parentElement.dataset.testid==="CloseIcon"||n.target.dataset.testid==="CloseIcon")&&De()}}),manualSorting:!W,onSortingChange:Ce,sortDescFirst:!1,enableColumnActions:!0,enableSorting:!0,muiTablePaperProps:()=>{var t,n;return{elevation:Z,sx:{...!i.formModal&&{visibility:s?"visible":"hidden",position:s?"auto":"fixed",height:s?"auto":0},order:((t=i==null?void 0:i.searchSettings)==null?void 0:t.searchFormPosition)===Bt.RIGHT?-1:1,gridRowStart:((n=i==null?void 0:i.searchSettings)==null?void 0:n.searchFormPosition)===Bt.BOTTOM?1:0,"&.pp-table table *":{boxSizing:"content-box"},"&.pp-table table":{overflowY:i.design.overflow===We.RESPONSIVE?"hidden":"auto",tableLayout:i.design.layout},...!i.showHeader&&{"&.pp-table table thead":{display:"none"}},...!i.showFooter&&Se.length===0&&{"&.pp-table table tfoot":{display:"none"}},"&.pp-table table tr th, &.pp-table table tr td":{...ke()<500&&i.design.overflow===We.RESPONSIVE&&{minWidth:0,maxWidth:0,textOverflow:"ellipsis"}},"& .pp-top-toolbar .MuiTablePagination-root":{padding:"16px",...ke()<480&&{flexDirection:"column",gap:0}},"& .pp-top-toolbar label.MuiFormLabel-root, & .pp-bottom-toolbar label.MuiFormLabel-root":{transform:"none",...ke()<600&&g.masterDetailConditions!==void 0&&{display:"none"}},"& .pp-bottom-toolbar label.MuiFormLabel-root":{...x.fontSize!==void 0&&{fontSize:`${x.fontSize}px !important`}},...Et()&&{transform:"translateZ(0px)",willChange:"transform"}},className:`pp-table pp-table-${X.getState().density} pp-table-${i.design.overflow}`+(je?" pp-table-sizer":"")+(ke()<500?" pp-table-mobile":"")}},muiTableHeadRowProps:{sx:{color:`${(x==null?void 0:x.color)[x.shade]} !important`}},muiBottomToolbarProps:()=>({className:"pp-bottom-toolbar",sx:{...!mt&&i.pagination.position==="top"&&{display:"none"},"& > div":{...ke()<500&&{display:"grid",width:"100%",justifyContent:"center","& .pp-bottom-toolbar-container":{marginLeft:0,display:"inline-block",textAlign:"center"},"& .MuiTablePagination-root":{justifyContent:"center",gap:0}}},"& .pp-bottom-toolbar-container":{font:"inherit",marginLeft:g.masterDetailConditions!==void 0?"8px":"1rem"},"& > .MuiBox-root > .MuiBox-root > .MuiBox-root":{alignItems:"center",paddingTop:0,paddingRight:ke()<500?0:"8px",paddingBottom:0,paddingLeft:0}}}),renderBottomToolbarCustomActions:()=>p.jsx(c.Suspense,{children:p.jsx(ho,{table:X,metaData:u,appId:r,showBuilderButton:mt,tableStore:f,appSettings:re,locale:ne,tableCode:Fe,app:ce,globalFilter:E,columnFilters:F,pagination:be,rowCount:W?X.getFilteredRowModel().rows.length:he,largeTableSupport:K,requery:ee})}),muiTableProps:{sx:{border:"unset","& th, td":{borderTop:"unset",borderRight:"unset",borderLeft:"unset"},margin:0,...Et()&&{transform:"translateZ(0px)",willChange:"transform"}}}});return m.debug(X),c.useEffect(()=>{g.requery!==void 0&&(m.debug("effect requery"),me())},[g.requery]),bt(()=>{if(!T.current){m.debug("effect viewLink + transactions");const t=X.getAllColumns();t[0].id==="mrt-row-actions"&&t[0].toggleVisibility(Ie)}},[i.viewLink,i.transactions]),eo(r,X,f,T,y,s,v,Ie,ye),c.useEffect(()=>{T.current||(m.debug("effect sync column filter fns"),De())},[o]),c.useEffect(()=>{T.current?(m.debug("effect refresh"),T.current=!1,ot({pageIndex:It(),pageSize:be.pageSize})):(m.debug("effect refetch"),me())},[d]),c.useEffect(()=>{i.searchSettings.searchFormAlwaysOpen&&(m.debug("effect search form always open"),w(Le({appId:r,property:{showColumnFilters:!0}})))},[i.searchSettings.searchFormAlwaysOpen]),c.useEffect(()=>{i.searchSettings.searchForm&&i.searchSettings.forceInline&&(m.debug("effect search open on startup"),w(Le({appId:r,property:{showColumnFilters:!0}}))),f.state.permissions.columnFilters===!1&&w(Le({appId:r,property:{showColumnFilters:!1}}))},[f.state.permissions.columnFilters]),c.useEffect(()=>{nt&&!W&&f.table.searchSettings.cascade===!0&&(m.debug("cascade search boxes"),Xe())},[E,F,q]),c.useEffect(()=>{f.table.maps.enabled&&(m.debug("effect update map data"),ie(r,X)),f.table.charts.enabled&&(m.debug("effect update chart data"),ue(X,f,u))},[rt,f.table.maps.enabled,f.table.charts.enabled,j==null?void 0:j.docked]),(it??!0)!==!1?null:p.jsxs(Ut,{sx:On(f,se()),className:"pp-table-container",ref:R,children:[p.jsx(kn,{table:X}),!1]})},Qo=Object.freeze(Object.defineProperty({__proto__:null,default:Co},Symbol.toStringTag,{value:"Module"}));export{Qo as T,Yt as a,Zt as b,Zn as c,Qn as u};
