const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Alert-1.0.61-BDxavmCg.js","./cm-1.0.61-D9ug3d5m.js","./redux-1.0.61-CrJ4jvTM.js","./vendor-1.0.61-CN03Eozo.js","./index-1.0.61-Cpig8940.js","./iconBase-1.0.61-C8saXaJ2.js","./Typography-1.0.61-Cg0Css-P.js","./lib-1.0.61-DoXQcMHD.js","./loglevel-1.0.61-BZ7XahX3.js","./lodash-1.0.61-C8OpKhUs.js","./moment-1.0.61-C5S46NFB.js","./ButtonBase-1.0.61-BqsrQx8o.js","./useEnhancedEffect-1.0.61-CX4-xj9Z.js","./AlertTitle-1.0.61-hpo1u3Vv.js","./createSvgIcon-1.0.61-DDgmYdEo.js","./Close-1.0.61-CiuKDfYz.js"])))=>i.map(i=>d[i]);
import{_ as re}from"./cmJson-1.0.61-BLURwXOE.js";import{C as Je,j as e,_ as $}from"./cm-1.0.61-D9ug3d5m.js";import{r as a}from"./redux-1.0.61-CrJ4jvTM.js";import{a as us,b as xs,c as ms,d as gs,e as Ht,f as hs,g as fs,h as js,l as Gt}from"./ActionsExplorer-1.0.61-Bj7vTxIj.js";import{a as Q,u as Qe}from"./hooks-1.0.61-Bklk-gZu.js";import{l as h,a as te,av as bs,aw as ys,ax as Ss,ay as Cs,az as Ts,aA as Is,aB as st,aC as vs,m as Ie,aD as ws,aE as Es,aF as ks,aG as nt,aH as at,aI as qt,aJ as Jt,aK as Ut,aL as Yt,aM as Ps,aN as _s,C as dt,ah as As,aO as Ms,aP as Ds,aQ as Ls}from"./lib-1.0.61-DoXQcMHD.js";import{B as l,S as Os}from"./Spinner-1.0.61-khi9zO7Q.js";import{c as Qt,j as Et,l as Rs,n as Xt,o as rt,f as zs,T as ve}from"./Typography-1.0.61-Cg0Css-P.js";import{u as Le,M as Oe,B as Rt}from"./index.esm-1.0.61-Dhj7A6Yv.js";import{T as fe,u as kt,a as Bs,b as Fs,c as Ns}from"./ActionsAdmin-1.0.61-DGFUYQF4.js";import{g as Zt,h as es,i as ts,e as Ks}from"./index-1.0.61-Cpig8940.js";import{I as it,J as Vs,K as Ws,e as Ue,f as $s,n as Hs,L as Gs,o as qs,A as ss,T as ns,N as Js,O as Us,P as as,Q as rs,M as is,R as Ys,S as Qs,U as Xs,l as Zs,y as zt,V as en,u as tn,v as sn,w as nn,j as an}from"./index-1.0.61-B7tjLD84.js";import{b as rn,c as on}from"./index-1.0.61-BRtOqdFl.js";import{u as os,h as St,a as Ct,T as ln,b as cn,c as dn,d as pn,e as un,f as xn,g as mn,i as gn,j as hn,k as Bt,t as ce,S as fn}from"./TreeItem2Provider-1.0.61-BYj1n-QF.js";import{C as me}from"./Checkbox-1.0.61-BlN5bjuH.js";import{a as Ft,e as Nt,r as Pe,P as ut}from"./ButtonBase-1.0.61-BqsrQx8o.js";import{C as jn}from"./Collapse-1.0.61-Cww0NnSm.js";import{E as ot}from"./ExplorerActionEnum-1.0.61-eclZgKpy.js";import{A as he}from"./AdminTheme-1.0.61-D8bUxwpM.js";import{u as bn}from"./index-1.0.61-CRnugLvI.js";import{L as _e}from"./Link-1.0.61-BHBICLVE.js";import{I as pe}from"./iconBase-1.0.61-C8saXaJ2.js";import{D as q}from"./DatabaseTypeEnum-1.0.61-DeJfpW1u.js";import{u as mt}from"./useExplorer-1.0.61-BwAinfQj.js";import{C as yn,b as Sn,a as Cn,c as Tn}from"./CardHeader-1.0.61-gDG-f_-J.js";import{F as ae,a as lt,T as Te,I as vt,b as ct}from"./TextField-1.0.61-DyvT2G_W.js";import{B as Me}from"./cjs-1.0.61-D_0erLfe.js";import{I as Kt}from"./InputAdornment-1.0.61-23wkGu1k.js";import{C as Pt}from"./ConfirmDialog-1.0.61-BrxkBu_y.js";import{A as wt}from"./AlertDialog-1.0.61-C93LQBsb.js";import{S as xt}from"./Select-1.0.61-DmroHcG5.js";import{M as ge}from"./MenuItem-1.0.61-Bmr1xWyp.js";import{T as _t,b as De,c as P,a as At}from"./TableRow-1.0.61-70IJJfOz.js";import{T as Mt}from"./TableHead-1.0.61-urAqheBu.js";import{T as pt}from"./Tooltip-1.0.61-De3BL3Jg.js";import{e as de}from"./notistack-1.0.61-0awN6uG4.js";import{d as Tt}from"./dayjs.min-1.0.61-21Xi_c_9.js";import{a as It}from"./RestApi-1.0.61-DdTZ_pIc.js";import{u as In}from"./useScreenSize-1.0.61-B4FX7-PC.js";import{N as vn}from"./react-number-format.es-1.0.61-3K4hYgeH.js";import{A as Vt}from"./Autocomplete-1.0.61-CP0PiliY.js";import{L as wn}from"./useMobilePicker-1.0.61-Dvb2yEEp.js";import{A as En}from"./AdapterDayjs-1.0.61-BqcEbIuB.js";import{D as kn}from"./DateTimePicker-1.0.61-B22uat3C.js";/* empty css                    */import"./vendor-1.0.61-CN03Eozo.js";import"./rehyperaw-1.0.61-AkovKNCK.js";import"./markdown-1.0.61-6nAzZWly.js";import"./loglevel-1.0.61-BZ7XahX3.js";import"./lodash-1.0.61-C8OpKhUs.js";import"./moment-1.0.61-C5S46NFB.js";import"./createSvgIcon-1.0.61-DDgmYdEo.js";import"./Stack-1.0.61-CNGwl0k7.js";import"./Radio-1.0.61-BXMcBwcB.js";import"./SwitchBase-1.0.61-C2xa6JFZ.js";import"./Modal-1.0.61-DVFPMIPt.js";import"./useEnhancedEffect-1.0.61-CX4-xj9Z.js";import"./Menu-1.0.61-D2OtRuzX.js";import"./ThemeProvider-1.0.61-4HOD8y6D.js";import"./Chip-1.0.61-C6TjQKDp.js";import"./AlertTitle-1.0.61-hpo1u3Vv.js";import"./Close-1.0.61-CiuKDfYz.js";import"./DialogContent-1.0.61-Ws3r0VFj.js";import"./ListItemIcon-1.0.61-P8epLVMP.js";import"./Divider-1.0.61-C8DX248W.js";import"./FormControlLabel-1.0.61-Bu2IQ4da.js";import"./Switch-1.0.61-CRYcdQMV.js";import"./Slider-1.0.61-BGScnB2M.js";import"./visuallyHidden-1.0.61-Dan1xhjv.js";import"./TimePicker-1.0.61-CeYQPlC5.js";import"./timeViewRenderers-1.0.61-Cu86BQXJ.js";import"./DatePicker-1.0.61-CDckGagl.js";import"./dateViewRenderers-1.0.61-7dkntk_V.js";import"./getThemeProps-1.0.61-OfsHdeDz.js";import"./ListItem-1.0.61-t1ycs9HY.js";import"./Tabs-1.0.61-Bhozjonn.js";function ls(t){const{instance:s,items:{onItemClick:r},selection:{multiSelect:i,checkboxSelection:c,disableSelection:p},expansion:{expansionTrigger:y}}=os(),j=s.isItemExpandable(t),C=s.isItemExpanded(t),x=s.isItemFocused(t),b=s.isItemSelected(t),d=s.isItemDisabled(t),m=s!=null&&s.isItemBeingEdited?s==null?void 0:s.isItemBeingEdited(t):!1,H=s.isItemEditable?s.isItemEditable(t):!1,z=f=>{if(!d){x||s.focusItem(f,t);const O=i&&(f.shiftKey||f.ctrlKey||f.metaKey);j&&!(O&&s.isItemExpanded(t))&&s.toggleItemExpansion(f,t)}},I=f=>{d||(x||s.focusItem(f,t),i&&(f.shiftKey||f.ctrlKey||f.metaKey)?f.shiftKey?s.expandSelectionRange(f,t):s.selectItem({event:f,itemId:t,keepExistingSelection:!0}):s.selectItem({event:f,itemId:t,shouldBeSelected:!0}))},v=f=>{if(p||d)return;const O=f.nativeEvent.shiftKey;i&&O?s.expandSelectionRange(f,t):s.selectItem({event:f,itemId:t,keepExistingSelection:i,shouldBeSelected:f.target.checked})},G=f=>{(f.shiftKey||f.ctrlKey||f.metaKey||d)&&f.preventDefault()},B=()=>{St(s,Ct)&&s.isItemEditable(t)&&(s.isItemBeingEdited(t)?s.setEditedItemId(null):s.setEditedItemId(t))};return{disabled:d,expanded:C,selected:b,focused:x,editable:H,editing:m,disableSelection:p,checkboxSelection:c,handleExpansion:z,handleSelection:I,handleCheckboxSelection:v,handleContentClick:r,preventSelection:G,expansionTrigger:y,toggleItemEditing:B,handleSaveItemLabel:(f,O)=>{St(s,Ct)&&s.isItemBeingEditedRef(t)&&(s.updateItemLabel(t,O),B(),s.focusItem(f,t))},handleCancelItemLabelEditing:f=>{St(s,Ct)&&s.isItemBeingEditedRef(t)&&(B(),s.focusItem(f,t))}}}const Pn=["classes","className","displayIcon","expansionIcon","icon","label","itemId","onClick","onMouseDown","dragAndDropOverlayProps","labelInputProps"],cs=a.forwardRef(function(s,r){const{classes:i,className:c,displayIcon:p,expansionIcon:y,icon:j,label:C,itemId:x,onClick:b,onMouseDown:d,dragAndDropOverlayProps:m,labelInputProps:H}=s,z=Je(s,Pn),{disabled:I,expanded:v,selected:G,focused:B,editing:E,editable:J,disableSelection:f,checkboxSelection:O,handleExpansion:w,handleSelection:M,handleCheckboxSelection:R,handleContentClick:S,preventSelection:N,expansionTrigger:o,toggleItemEditing:g}=ls(x),u=j||y||p,_=a.useRef(null),A=V=>{N(V),d&&d(V)},K=V=>{var Y;S==null||S(V,x),!((Y=_.current)!=null&&Y.contains(V.target))&&(o==="content"&&w(V),O||M(V),b&&b(V))},F=V=>{V.defaultMuiPrevented||g()};return e.jsxs("div",$({},z,{className:Qt(i.root,c,v&&i.expanded,G&&i.selected,B&&i.focused,I&&i.disabled,E&&i.editing,J&&i.editable),onClick:K,onMouseDown:A,ref:r,children:[e.jsx("div",{className:i.iconContainer,children:u}),O&&e.jsx(me,{className:i.checkbox,checked:G,onChange:R,disabled:I||f,ref:_,tabIndex:-1}),E?e.jsx(ln,$({},H,{className:i.labelInput})):e.jsx("div",$({className:i.label},J&&{onDoubleClick:F},{children:C})),m&&e.jsx(cn,$({},m))]}))}),_n=["children","className","slots","slotProps","ContentComponent","ContentProps","itemId","id","label","onClick","onMouseDown","onFocus","onBlur","onKeyDown"],An=["ownerState"],Mn=["ownerState"],Dn=["ownerState"],Ln=pn(),On=t=>{const{classes:s}=t;return Rs({root:["root"],content:["content"],expanded:["expanded"],selected:["selected"],focused:["focused"],disabled:["disabled"],iconContainer:["iconContainer"],checkbox:["checkbox"],label:["label"],labelInput:["labelInput"],editing:["editing"],editable:["editable"],groupTransition:["groupTransition"]},hn,s)},Rn=Et("li",{name:"MuiTreeItem",slot:"Root",overridesResolver:(t,s)=>s.root})({listStyle:"none",margin:0,padding:0,outline:0}),zn=Et(cs,{name:"MuiTreeItem",slot:"Content",overridesResolver:(t,s)=>[s.content,s.iconContainer&&{[`& .${ce.iconContainer}`]:s.iconContainer},s.label&&{[`& .${ce.label}`]:s.label}],shouldForwardProp:t=>Xt(t)&&t!=="indentationAtItemLevel"})(({theme:t})=>({padding:t.spacing(.5,1),borderRadius:t.shape.borderRadius,width:"100%",boxSizing:"border-box",position:"relative",display:"flex",alignItems:"center",gap:t.spacing(1),cursor:"pointer",WebkitTapHighlightColor:"transparent","&:hover":{backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${ce.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity,backgroundColor:"transparent"},[`&.${ce.focused}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${ce.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:rt(t.palette.primary.main,t.palette.action.selectedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:rt(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:rt(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${ce.focused}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:rt(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`& .${ce.iconContainer}`]:{width:16,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},[`& .${ce.label}`]:$({width:"100%",boxSizing:"border-box",minWidth:0,position:"relative"},t.typography.body1),[`& .${ce.checkbox}`]:{padding:0},variants:[{props:{indentationAtItemLevel:!0},style:{paddingLeft:`calc(${t.spacing(1)} + var(--TreeView-itemChildrenIndentation) * var(--TreeView-itemDepth))`}}]})),Bn=Et(jn,{name:"MuiTreeItem",slot:"GroupTransition",overridesResolver:(t,s)=>s.groupTransition,shouldForwardProp:t=>Xt(t)&&t!=="indentationAtItemLevel"})({margin:0,padding:0,paddingLeft:"var(--TreeView-itemChildrenIndentation)",variants:[{props:{indentationAtItemLevel:!0},style:{paddingLeft:0}}]}),ee=a.forwardRef(function(s,r){var We,$e,He,Dt;const{icons:i,runItemPlugins:c,items:{disabledItemsFocusable:p,indentationAtItemLevel:y},selection:{disableSelection:j},expansion:{expansionTrigger:C},treeId:x,instance:b}=os(),d=a.useContext(dn),m=Ln({props:s,name:"MuiTreeItem"}),{children:H,className:z,slots:I,slotProps:v,ContentComponent:G=cs,ContentProps:B,itemId:E,id:J,label:f,onClick:O,onMouseDown:w,onBlur:M,onKeyDown:R}=m,S=Je(m,_n),{expanded:N,focused:o,selected:g,disabled:u,editing:_,handleExpansion:A,handleCancelItemLabelEditing:K,handleSaveItemLabel:F}=ls(E),{contentRef:V,rootRef:Y,propsEnhancers:W}=c(m),D=a.useRef(null),X=a.useRef(null),be=Ft(r,Y,D),ue=Ft(B==null?void 0:B.ref,V,X),se={expandIcon:(I==null?void 0:I.expandIcon)??i.slots.expandIcon??xn,collapseIcon:(I==null?void 0:I.collapseIcon)??i.slots.collapseIcon??un,endIcon:(I==null?void 0:I.endIcon)??i.slots.endIcon,icon:I==null?void 0:I.icon,groupTransition:I==null?void 0:I.groupTransition},ne=k=>Array.isArray(k)?k.length>0&&k.some(ne):!!k,ye=ne(H),xe=$({},m,{expanded:N,focused:o,selected:g,disabled:u,indentationAtItemLevel:y}),U=On(xe),Se=se.groupTransition??void 0,Xe=it({elementType:Se,ownerState:{},externalSlotProps:v==null?void 0:v.groupTransition,additionalProps:$({unmountOnExit:!0,in:N,component:"ul",role:"group"},y?{indentationAtItemLevel:!0}:{}),className:U.groupTransition}),Ze=k=>{C==="iconContainer"&&A(k)},we=N?se.collapseIcon:se.expandIcon,gt=it({elementType:we,ownerState:{},externalSlotProps:k=>N?$({},Pe(i.slotProps.collapseIcon,k),Pe(v==null?void 0:v.collapseIcon,k)):$({},Pe(i.slotProps.expandIcon,k),Pe(v==null?void 0:v.expandIcon,k)),additionalProps:{onClick:Ze}}),Be=Je(gt,An),ht=ye&&we?e.jsx(we,$({},Be)):null,Fe=ye?void 0:se.endIcon,ft=it({elementType:Fe,ownerState:{},externalSlotProps:k=>ye?{}:$({},Pe(i.slotProps.endIcon,k),Pe(v==null?void 0:v.endIcon,k))}),jt=Je(ft,Mn),bt=Fe?e.jsx(Fe,$({},jt)):null,Ne=se.icon,yt=it({elementType:Ne,ownerState:{},externalSlotProps:v==null?void 0:v.icon}),n=Je(yt,Dn),T=Ne?e.jsx(Ne,$({},n)):null;let L;g?L=!0:j||u?L=void 0:L=!1;function Z(k){!o&&(!u||p)&&k.currentTarget===k.target&&b.focusItem(k,E)}function ie(k){var ke,Ge,Lt,Ot;M==null||M(k),!(_||k.relatedTarget&&Bt(k.relatedTarget,D.current)&&(k.target&&((Ge=(ke=k.target)==null?void 0:ke.dataset)==null?void 0:Ge.element)==="labelInput"&&Bt(k.target,D.current)||((Ot=(Lt=k.relatedTarget)==null?void 0:Lt.dataset)==null?void 0:Ot.element)==="labelInput"))&&b.removeFocusedItem()}const oe=k=>{var ke,Ge;R==null||R(k),((Ge=(ke=k.target)==null?void 0:ke.dataset)==null?void 0:Ge.element)!=="labelInput"&&b.handleItemKeyDown(k,E)},le=gn({itemId:E,treeId:x,id:J}),Ee=b.canItemBeTabbed(E)?0:-1,Ce={rootRefObject:D,contentRefObject:X,interactions:{handleSaveItemLabel:F,handleCancelItemLabelEditing:K}},et=((We=W.root)==null?void 0:We.call(W,$({},Ce,{externalEventHandlers:Nt(S)})))??{},tt=(($e=W.content)==null?void 0:$e.call(W,$({},Ce,{externalEventHandlers:Nt(B)})))??{},Ke=((He=W.dragAndDropOverlay)==null?void 0:He.call(W,$({},Ce,{externalEventHandlers:{}})))??{},Ve=((Dt=W.labelInput)==null?void 0:Dt.call(W,$({},Ce,{externalEventHandlers:{}})))??{};return e.jsx(mn,{itemId:E,children:e.jsxs(Rn,$({className:Qt(U.root,z),role:"treeitem","aria-expanded":ye?N:void 0,"aria-selected":L,"aria-disabled":u||void 0,id:le,tabIndex:Ee},S,{ownerState:xe,onFocus:Z,onBlur:ie,onKeyDown:oe,ref:be,style:y?$({},S.style,{"--TreeView-itemDepth":typeof d=="function"?d(E):d}):S.style},et,{children:[e.jsx(zn,$({as:G,classes:{root:U.content,expanded:U.expanded,selected:U.selected,focused:U.focused,disabled:U.disabled,editable:U.editable,editing:U.editing,iconContainer:U.iconContainer,label:U.label,labelInput:U.labelInput,checkbox:U.checkbox},label:f,itemId:E,onClick:O,onMouseDown:w,icon:T,expansionIcon:ht,displayIcon:bt,ownerState:xe},B,tt,Ke.action==null?{}:{dragAndDropOverlayProps:Ke},Ve.value==null?{}:{labelInputProps:Ve},{ref:ue})),H&&e.jsx(Bn,$({as:Se},Xe,{children:H}))]}))})}),je=()=>e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"10px",padding:"30px"},children:[e.jsx(zs,{sx:{width:"1em !important",height:"1em !important"}}),e.jsx(ve,{children:"Loading..."})]}),Re={columns:[],data:[],initialState:{},enableColumnActions:!1,enableColumnFilters:!1,enablePagination:!1,enableSorting:!1,enableBottomToolbar:!1,enableTopToolbar:!1,muiTablePaperProps:{sx:{display:"grid",boxShadow:"none"}},muiTableProps:{sx:{border:"unset","& th, td":{borderTop:"unset",borderRight:"unset",borderLeft:"unset"}}},muiTableHeadCellProps:{sx:{paddingTop:"1rem",paddingRight:"1rem",paddingBottom:"1rem",paddingLeft:"1rem"}},muiTableBodyRowProps:{hover:!0},muiTableBodyCellProps:{sx:{verticalAlign:"top"}}},ze=({msg:t})=>e.jsx(l,{sx:{padding:"1rem 0"},children:e.jsx(ve,{children:t})}),Fn=a.lazy(()=>re(()=>import("./Alert-1.0.61-BDxavmCg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),Nn=({dbs:t,tbl:s,database:r})=>{h.debug(t,s);const i=Q(),c=r.columnsLoaded[s]??!1,p=a.useMemo(()=>(r==null?void 0:r.columns[s])??[],[r.columns]),[y,j]=a.useState("");a.useEffect(()=>{c||C()},[c]);const C=()=>{us(t,s,d=>{const m=d==null?void 0:d.data;h.debug("response data",m),i(bs({dbs:t,tbl:s,cls:m}))},d=>{console.error("error",d),j(d??te.contactSupport)})},x=a.useMemo(()=>[{accessorKey:"ordinal_position",header:"#",size:40},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"column_type",header:"Column type",size:100},{accessorKey:"is_nullable",header:"Nullable?",size:50},{accessorKey:"character_maximum_length",header:"Max length",size:70,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"numeric_precision",header:"Precision",size:60,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"numeric_scale",header:"Scale",size:60,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"extra",header:"Extra",size:100},{accessorKey:"column_default",header:"Default value",size:100}],[]),b=Le({...Re,columns:x,data:p,initialState:{columnOrder:["ordinal_position","column_name","column_type","is_nullable","extra","column_default","character_maximum_length","numeric_precision","numeric_scale"],density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return h.debug(b),y!==""?e.jsx(a.Suspense,{children:e.jsx(Fn,{severity:"error",message:y,close:!1})}):c?c&&p.length===0?e.jsx(ze,{msg:"Table has no columns"}):(h.debug(p),e.jsx(Oe,{table:b})):e.jsx(je,{})},Kn=a.lazy(()=>re(()=>import("./Alert-1.0.61-BDxavmCg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),Vn=({dbs:t,tbl:s,database:r})=>{h.debug(t,s);const i=Q(),c=r.indexesLoaded[s]??!1,p=a.useMemo(()=>(r==null?void 0:r.indexes[s])??[],[r.indexes]),[y,j]=a.useState("");a.useEffect(()=>{c||C()},[c]);const C=()=>{xs(t,s,d=>{const m=d==null?void 0:d.data;h.debug("response data",m),i(ys({dbs:t,tbl:s,idx:m}))},d=>{console.error("error",d),j(d??te.contactSupport)})},x=a.useMemo(()=>[{accessorKey:"index_name",header:"Index name",size:100},{accessorKey:"non_unique",header:"Unique",size:80},{accessorKey:"seq_in_name",header:"#",size:40,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"collation",header:"Collation",size:80},{accessorKey:"nullable",header:"Nullable?",size:80},{accessorKey:"index_type",header:"Index type",size:100},{accessorKey:"cardinality",header:"Cardinality",size:80,muiTableHeadCellProps:{align:"right"},muiTableBodyCellProps:{align:"right"}}],[]),b=Le({...Re,columns:x,data:p,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return h.debug(b),y!==""?e.jsx(a.Suspense,{children:e.jsx(Kn,{severity:"error",message:y,close:!1})}):c?c&&p.length===0?e.jsx(ze,{msg:"Table has no indexes"}):e.jsx(Oe,{table:b}):e.jsx(je,{})},Wn=a.lazy(()=>re(()=>import("./Alert-1.0.61-BDxavmCg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),$n=({dbs:t,tbl:s,database:r})=>{h.debug(t,s);const i=Q(),c=r.triggersLoaded[s]??!1,p=a.useMemo(()=>(r==null?void 0:r.triggers[s])??[],[r.triggers]),[y,j]=a.useState("");a.useEffect(()=>{c||C()},[c]);const C=()=>{ms(t,s,d=>{const m=d==null?void 0:d.data;h.debug("response data",m),i(Ss({dbs:t,tbl:s,trg:m}))},d=>{console.error("error",d),j(d??te.contactSupport)})},x=a.useMemo(()=>[{accessorKey:"trigger_name",header:"Trigger name",size:120},{accessorKey:"event_manipulation",header:"Event",size:80},{accessorKey:"action_timing",header:"Timin",size:80},{accessorKey:"action_statement",header:"SQL",size:200,Cell:({cell:d})=>e.jsx("pre",{style:{padding:0,margin:0},children:d.getValue()})}],[]),b=Le({...Re,columns:x,data:p,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return h.debug(b),y!==""?e.jsx(a.Suspense,{children:e.jsx(Wn,{severity:"error",message:y,close:!1})}):c?c&&p.length===0?e.jsx(ze,{msg:"Table has no triggers"}):e.jsx(Oe,{table:b}):e.jsx(je,{})},Hn=a.lazy(()=>re(()=>import("./Alert-1.0.61-BDxavmCg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),Gn=({dbs:t,tbl:s,database:r})=>{h.debug(t,s);const i=Q(),c=r.foreignKeysLoaded[s]??!1,p=a.useMemo(()=>(r==null?void 0:r.foreignKeys[s])??[],[r.foreignKeys]),[y,j]=a.useState("");a.useEffect(()=>{c||C()},[c]);const C=()=>{gs(t,s,d=>{const m=d==null?void 0:d.data;h.debug("response data",m),i(Cs({dbs:t,tbl:s,frk:m}))},d=>{console.error("error",d),j(d)})},x=a.useMemo(()=>[{accessorKey:"constraint_name",header:"Constraint name",size:100},{accessorKey:"column_name",header:"Column name",size:100},{accessorKey:"referenced_table_name",header:"Referenced table",size:100},{accessorKey:"referenced_column_name",header:"Referenced column",size:100}],[]),b=Le({...Re,columns:x,data:p,initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return h.debug(b),y!==""?e.jsx(a.Suspense,{children:e.jsx(Hn,{severity:"error",message:y,close:!1})}):c?c&&p.length===0?e.jsx(ze,{msg:"Table contains no foreign keys"}):e.jsx(Oe,{table:b}):e.jsx(je,{})},ds=a.memo(({dbs:t,tbl:s,typ:r,database:i})=>(h.debug(t,s,r),e.jsxs(e.Fragment,{children:[e.jsx(ee,{itemId:t+"-"+s+"-columns",label:e.jsxs(l,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Vs,{}),e.jsx("span",{children:"Columns"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Nn,{dbs:t,tbl:s,database:i})}),r===fe.TABLE&&e.jsxs(e.Fragment,{children:[e.jsx(ee,{itemId:t+"-"+s+"-indexes",label:e.jsxs(l,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Ws,{}),e.jsx("span",{children:"Indexes"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Vn,{dbs:t,tbl:s,database:i})}),e.jsx(ee,{itemId:t+"-"+s+"-foreignkeys",label:e.jsxs(l,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(rn,{}),e.jsx("span",{children:"Foreign Keys"})]}),sx:{padding:0,minWidth:0},children:e.jsx(Gn,{dbs:t,tbl:s,database:i})}),e.jsx(ee,{itemId:t+"-"+s+"-triggers",label:e.jsxs(l,{sx:{display:"inline-grid",gridTemplateColumns:"auto auto",gap:"10px",alignItems:"center"},children:[e.jsx(Zt,{}),e.jsx("span",{children:"Triggers"})]}),sx:{padding:0,minWidth:0},children:e.jsx($n,{dbs:t,tbl:s,database:i})})]})]}))),ps=a.memo(({dbs:t,tbl:s,typ:r,tableContext:i,database:c})=>{var b,d;h.debug(t,s,r);const p=Q(),y=c.tablesSelected,j=c.viewsSelected,C=bn("(max-width:900px)"),x=a.useMemo(()=>(i==null?void 0:i.wp_tables)!==void 0&&i.wp_tables.filter(m=>m===s).length>0?" (WordPress Table)":(i==null?void 0:i.wpda_tables)!==void 0&&i.wpda_tables.filter(m=>m===s).length>0?" (Plugin Table)":"",[]);return e.jsxs(l,{color:"primary",sx:{display:"grid",gridTemplateColumns:"calc(100% - 110px) auto",justifyContent:"space-between",alignItems:"center",gridGap:"20px",marginLeft:"-10px","&:hover":{".pp-row-actions":{visibility:C?"hidden":"visible"}}},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gridGap:"0",overflow:"hidden"},children:[e.jsx(l,{sx:{display:"grid",alignItems:"center"},children:e.jsx(me,{size:"small",checked:j.includes(s)||y.includes(s),onClick:m=>{r===fe.VIEW?p(Ts({dbs:t,vws:s,isSelected:!j.includes(s)})):p(Is({dbs:t,tbl:s,isSelected:!y.includes(s)})),m.stopPropagation()}})}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"stretch"},children:[e.jsxs(l,{sx:{textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[s," ",x]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto auto auto",gridGap:"10px",marginLeft:"10px",alignItems:"center",visibility:"hidden"},className:"pp-row-actions",children:[e.jsx(l,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(Ue,{title:"Manage table `"+s+"`",placement:"bottom",children:e.jsx(_e,{underline:"none",onClick:m=>{p(st({dbs:t,tbl:s,typ:r,explorerAction:ot.MANAGE})),m.preventDefault(),m.stopPropagation()},children:"Manage"})}),e.jsx(l,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(Ue,{title:"Explore table `"+s+"`",placement:"bottom",children:e.jsx(_e,{underline:"none",onClick:m=>{p(st({dbs:t,tbl:s,typ:r,explorerAction:ot.EXPLORE})),m.preventDefault(),m.stopPropagation()},children:"Explore"})})]})]})]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"space-evenly",alignItems:"center"},children:[e.jsx(Ue,{title:"Manage table `"+s+"`",placement:"bottom",children:e.jsx(pe,{sx:{color:(b=he)==null?void 0:b.palette.primary.main},onClick:m=>{p(st({dbs:t,tbl:s,typ:r,explorerAction:ot.MANAGE})),m.preventDefault(),m.stopPropagation()},children:e.jsx($s,{})})}),e.jsx(Ue,{title:"Explore table `"+s+"`",placement:"bottom",children:e.jsx(pe,{sx:{color:(d=he)==null?void 0:d.palette.primary.main},onClick:m=>{p(st({dbs:t,tbl:s,typ:r,explorerAction:ot.EXPLORE})),m.preventDefault(),m.stopPropagation()},children:e.jsx(Hs,{})})})]})]})}),qn=a.lazy(()=>re(()=>import("./Alert-1.0.61-BDxavmCg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),Jn=a.memo(({dbs:t,search:s,database:r})=>{const i=Q();h.debug(t,s);const c=r.tablesLoaded,p=r.tables,y=r.tablesContext,[j,C]=a.useState("");return a.useEffect(()=>{c||Ht(t,function(x){const b=x==null?void 0:x.data;h.debug("response data",b),i(vs({dbs:t,tbl:b,context:x.context??void 0}))},x=>{console.error("error",x),C(x??te.contactSupport)})},[c]),j!==""?e.jsx(a.Suspense,{children:e.jsx(qn,{severity:"error",message:j,close:!1})}):c?c&&p.length===0?e.jsx(l,{sx:{padding:"1rem"},children:e.jsx(ve,{children:"Database contains no tables"})}):e.jsxs(e.Fragment,{children:[...p.map(x=>{const b=!Ie(x,s);return e.jsx(ee,{itemId:t+"-"+x,label:e.jsx(ps,{dbs:t,tbl:x,typ:fe.TABLE,tableContext:y,database:r}),sx:{visibility:b?"hidden":"inherit",position:b?"fixed !important":"inherit"},children:e.jsx(ds,{dbs:t,tbl:x,typ:fe.TABLE,database:r})})})]}):e.jsx(je,{})}),Un=a.lazy(()=>re(()=>import("./Alert-1.0.61-BDxavmCg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),Yn=({dbs:t,search:s,database:r})=>{const i=Q();h.debug(t,s);const c=r.viewsLoaded,p=r.views,[y,j]=a.useState("");a.useEffect(()=>{c||C()},[c]);const C=()=>{hs(t,x=>{const b=x==null?void 0:x.data;h.debug("response data",b),i(ws({dbs:t,vws:b}))},x=>{console.error("error",x),j(x??te.contactSupport)})};return y!==""?e.jsx(a.Suspense,{children:e.jsx(Un,{severity:"error",message:y,close:!1})}):c?c&&p.length===0?e.jsx(l,{sx:{padding:"1rem"},children:e.jsx(ve,{children:"Database contains no views"})}):e.jsxs(e.Fragment,{children:[...p.map(x=>{const b=!Ie(x,s);return e.jsx(ee,{itemId:t+"-"+x,label:e.jsx(ps,{dbs:t,tbl:x,typ:fe.VIEW,database:r}),sx:{visibility:b?"hidden":"unset",position:b?"fixed !important":"inherit"},children:e.jsx(ds,{dbs:t,tbl:x,typ:fe.VIEW,database:r})})})]}):e.jsx(je,{})},Qn=a.lazy(()=>re(()=>import("./Alert-1.0.61-BDxavmCg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),Xn=({dbs:t,search:s,database:r})=>{h.debug(t,s);const i=Q(),c=r.proceduresLoaded,p=r.procedures,[y,j]=a.useState("");a.useEffect(()=>{c||C()},[c]);const C=()=>{fs(t,d=>{const m=d==null?void 0:d.data;h.debug("response data",m),i(Es({dbs:t,prc:m}))},d=>{console.error("error",d),j(d??te.contactSupport)})},x=a.useMemo(()=>[{accessorKey:"routine_name",header:"Name",size:100},{accessorKey:"routine_definition",header:"Body",size:300,Cell:({cell:d})=>e.jsx("pre",{style:{padding:0,margin:0},children:d.getValue()})}],[]),b=Le({...Re,columns:x,data:p.filter(d=>Ie(d.routine_name,s)),initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return h.debug(b),y!==""?e.jsx(a.Suspense,{children:e.jsx(Qn,{severity:"error",message:y,close:!1})}):c?c&&p.length===0?e.jsx(ze,{msg:"Database contains no stored procedures"}):e.jsx(Oe,{table:b}):e.jsx(je,{})},Zn=a.lazy(()=>re(()=>import("./Alert-1.0.61-BDxavmCg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),ea=({dbs:t,search:s,database:r})=>{h.debug(t,s);const i=Q(),c=r.functionsLoaded,p=r.functions,[y,j]=a.useState("");a.useEffect(()=>{c||C()},[c]);const C=()=>{js(t,d=>{const m=d==null?void 0:d.data;h.debug("response data",m),i(ks({dbs:t,fnc:m}))},d=>{console.error("error",d),j(d??te.contactSupport)})},x=a.useMemo(()=>[{accessorKey:"routine_name",header:"Name",size:100},{accessorKey:"routine_definition",header:"Body",size:300,Cell:({cell:d})=>e.jsx("pre",{style:{padding:0,margin:0},children:d.getValue()})}],[]),b=Le({...Re,columns:x,data:p.filter(d=>Ie(d.routine_name,s)),initialState:{density:"comfortable"},muiTableProps:{className:"pp-explorer-table"}});return h.debug(b),y!==""?e.jsx(a.Suspense,{children:e.jsx(Zn,{severity:"error",message:y,close:!1})}):c?c&&p.length===0?e.jsx(ze,{msg:"Database contains no functions"}):e.jsx(Oe,{table:b}):e.jsx(je,{})},ta=({setShowFilter:t})=>{const s=Q(),i=mt().dbsTypes;return a.useEffect(()=>{try{localStorage.setItem("ppExplorerSearchDbsTypes",JSON.stringify(i))}catch(c){h.debug(c)}},[i]),e.jsxs(yn,{sx:{position:"absolute",top:"3em",right:"0",minWidth:"-webkit-fill-available",zIndex:9999999},children:[e.jsx(Sn,{title:"Database filter",sx:{textAlign:"center"}}),e.jsx(Cn,{sx:{textAlign:"center",padding:0,borderTop:"1px solid #eee",borderBottom:"1px solid #eee"},children:e.jsxs(l,{sx:{display:"inline-grid",textAlign:"left",padding:"2em","& label":{display:"flex",alignItems:"center"}},children:[e.jsx(ae,{children:e.jsxs(lt,{children:[e.jsx(me,{size:"small",checked:i.includes(q.WP),onChange:(c,p)=>{s(p?nt({dbsType:q.WP}):at({dbsType:q.WP}))}}),"WordPress database"]})}),e.jsx(ae,{children:e.jsxs(lt,{children:[e.jsx(me,{size:"small",checked:i.includes(q.LOCAL),onChange:(c,p)=>{s(p?nt({dbsType:q.LOCAL}):at({dbsType:q.LOCAL}))}}),"Local databases"]})}),e.jsx(ae,{children:e.jsxs(lt,{children:[e.jsx(me,{size:"small",checked:i.includes(q.REMOTE),onChange:(c,p)=>{s(p?nt({dbsType:q.REMOTE}):at({dbsType:q.REMOTE}))}}),"Remote databases"]})}),e.jsx(ae,{children:e.jsxs(lt,{children:[e.jsx(me,{size:"small",checked:i.includes(q.SYSTEM),onChange:(c,p)=>{s(p?nt({dbsType:q.SYSTEM}):at({dbsType:q.SYSTEM}))}}),"System databases"]})})]})}),e.jsxs(Tn,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr"},children:[e.jsx(l,{}),e.jsx(Me,{variant:"contained",onClick:()=>t(!1),children:"OK"})]})]})},Ae=({search:t,setSearch:s,addFilter:r})=>{h.debug(t,r);const[i,c]=a.useState(!1);return e.jsxs(l,{sx:{position:"relative"},children:[e.jsx(Te,{className:"pp-explorer-search-field",value:t,type:"search",onChange:p=>{s(p.target.value)},onClick:p=>{p.stopPropagation()},onKeyDown:p=>{p.stopPropagation()},sx:{backgroundColor:"#fff",fontSize:"1em",margin:0,padding:0,borderRadius:"4px","&.MuiFormControl-root.MuiTextField-root .MuiInputBase-root":{paddingRight:0},"&.MuiFormControl-root.MuiTextField-root input":{padding:"8px"}},slotProps:{input:{startAdornment:e.jsx(Kt,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(qs,{})}),endAdornment:e.jsx(e.Fragment,{children:r&&e.jsx(Kt,{position:"end",sx:{fontSize:"1.5rem",padding:0,margin:0},children:e.jsx(pe,{onClick:()=>{c(!i)},children:e.jsx(Gs,{})})})})}}}),i&&e.jsx(ta,{setShowFilter:c})]})},sa=(t,s)=>{const r=Qe(i=>i.explorer.database===void 0||i.explorer.database===null||i.explorer.database[t].tables.length===0?!1:i.explorer.database[t].tables.filter(p=>Ie(p,s)).length===i.explorer.database[t].tablesSelected.length);return h.debug("allTablesSelected",r),r},na=(t,s)=>{const r=Qe(i=>i.explorer.database===void 0||i.explorer.database===null||i.explorer.database[t].views.length===0?!1:i.explorer.database[t].views.filter(p=>Ie(p,s)).length===i.explorer.database[t].viewsSelected.length);return h.debug("allViewsSelected",r),r},Ye=t=>{let s="";try{s=localStorage.getItem(t)??""}catch(p){h.debug(p)}const[r,i]=a.useState(s),c=p=>{i(p);try{localStorage.setItem(t,p)}catch(y){h.debug(y)}};return h.debug(r),{search:r,setSearch:c}},aa=a.memo(({dbs:t,density:s})=>{h.debug(t);const r=Q(),[i,c]=a.useState(!1),{search:p,setSearch:y}=Ye(`ppExplorerSearchTables-${t}`);h.debug(i,p);const[j,C]=a.useState(!1),{search:x,setSearch:b}=Ye(`ppExplorerSearchViews-${t}`);h.debug(j,x);const[d,m]=a.useState(!1),{search:H,setSearch:z}=Ye(`ppExplorerSearchProcedures-${t}`);h.debug(d,H);const[I,v]=a.useState(!1),{search:G,setSearch:B}=Ye(`ppExplorerSearchFunctions-${t}`);h.debug(I,G);const E=sa(t,p),J=na(t,x),[f,O]=a.useState("");h.debug(f);const w=kt(),M=w[t],R=()=>s==="small"?0:s==="medium"?"6px":"12px";return e.jsxs(e.Fragment,{children:[e.jsx(ee,{itemId:t+"-tables",className:"pp-data-exporer-table-tree-item "+f,onClickCapture:S=>{var N,o;!(S.target instanceof HTMLInputElement)&&!(S.target instanceof HTMLAnchorElement)&&!((N=S.target.closest("span"))!=null&&N.classList.contains("pp-select-all-tables"))&&((o=S.target.closest("li"))!=null&&o.classList.contains("pp-data-exporer-table-tree-item"))&&(O(f===""?"hide-details":""),i?S.stopPropagation():(c(!0),O("")))},sx:{padding:0,minWidth:0,"&.hide-details > ul":{visibility:"hidden",position:"fixed"}},label:e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:i&&f===""?0:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[i&&f===""?e.jsx(me,{size:"small",className:"pp-select-all-tables",checked:E,onClick:S=>{r(qt({dbs:t,isSelected:!E,search:p})),S.stopPropagation()},sx:{marginLeft:"-12px"}}):e.jsx(es,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Tables"}),e.jsx("span",{style:{fontSize:"90%"},children:w[t].tablesLoaded===!0?"("+w[t].tables.length+"/"+w[t].tablesSelected.length+")":""})]})]}),e.jsxs(l,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(l,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(_e,{underline:"none",onClick:S=>{r(Jt({dbs:t})),S.preventDefault(),S.stopPropagation()},children:"Refresh"})]})]}),e.jsx(l,{sx:{marginRight:R()},children:i&&f===""&&e.jsx(Ae,{search:p,setSearch:y})})]}),children:e.jsx(Jn,{dbs:t,search:p,database:M})}),e.jsx(ee,{itemId:t+"-views",onClick:()=>{C(!j)},label:e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:j?0:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[j?e.jsx(me,{size:"small",checked:J,onClick:S=>{r(Ut({dbs:t,isSelected:!J,search:x})),S.stopPropagation()},sx:{marginLeft:"-12px"}}):e.jsx(ts,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Views"}),e.jsx("span",{style:{fontSize:"90%"},children:w[t].viewsLoaded===!0?"("+w[t].views.length+"/"+w[t].viewsSelected.length+")":""})]})]}),e.jsxs(l,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(l,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(_e,{underline:"none",onClick:S=>{r(Yt({dbs:t})),S.preventDefault(),S.stopPropagation()},children:"Refresh"})]})]}),e.jsx(l,{sx:{marginRight:R()},children:j&&e.jsx(Ae,{search:x,setSearch:b})})]}),sx:{padding:0,minWidth:0},children:e.jsx(Yn,{dbs:t,search:x,database:M})}),e.jsx(ee,{itemId:t+"-procedures",onClick:()=>{m(!d)},label:e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[e.jsx(Zt,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Stored Procedures"}),e.jsx("span",{style:{fontSize:"90%"},children:w[t].proceduresLoaded===!0?"("+w[t].procedures.length+")":""})]})]}),e.jsxs(l,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(l,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(_e,{underline:"none",onClick:S=>{r(Ps({dbs:t})),S.preventDefault(),S.stopPropagation()},children:"Refresh"})]})]}),e.jsx(l,{sx:{marginRight:R()},children:d&&e.jsx(Ae,{search:H,setSearch:z})})]}),sx:{padding:0,minWidth:0},children:e.jsx(Xn,{dbs:t,search:H,database:M})}),e.jsx(ee,{itemId:t+"-functions",onClick:()=>{v(!I)},label:e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"20px",justifyContent:"space-between",alignItems:"center","&:hover":{".pp-row-actions":{display:"grid"}}},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"10px",justifyContent:"space-between",alignItems:"center",margin:"0 8px 0 4px"},children:[e.jsx(on,{}),e.jsxs("span",{style:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx("span",{children:"Functions"}),e.jsx("span",{style:{fontSize:"90%"},children:w[t].functionsLoaded===!0?"("+w[t].functions.length+")":""})]})]}),e.jsxs(l,{className:"pp-row-actions",sx:{display:"none",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:[e.jsx(l,{sx:{borderLeft:"1px solid black",height:"100%"}}),e.jsx(_e,{underline:"none",onClick:S=>{r(_s({dbs:t})),S.preventDefault(),S.stopPropagation()},children:"Refresh"})]})]}),e.jsx(l,{sx:{marginRight:R()},children:I&&e.jsx(Ae,{search:G,setSearch:B})})]}),sx:{padding:0,minWidth:0},children:e.jsx(ea,{dbs:t,search:G,database:M})})]})}),ra=()=>{const t=Qe(s=>s.explorer.database===void 0||s.explorer.database===null?0:Object.keys(s.explorer.database).map(r=>s.explorer.database[r].tablesSelected).flat().length);return h.debug("countSelectedTables",t),t},ia=()=>{const t=Qe(s=>s.explorer.database===void 0||s.explorer.database===null?!1:Object.keys(s.explorer.database).filter(r=>s.explorer.database[r].tablesSelected.length>0||s.explorer.database[r].viewsSelected.length>0).length>0);return h.debug("hasBulkActions",t),t},oa=()=>{const t=Qe(s=>s.explorer.database===void 0||s.explorer.database===null?0:Object.keys(s.explorer.database).map(r=>s.explorer.database[r].viewsSelected).flat().length);return h.debug("countSelectedViews",t),t},qe={export:"Export table(s)",truncate:"Truncate table(s)",drop:"Drop table(s)/view(s)"},la=()=>{const t=Q(),s=ia(),r=mt(),i=kt(),c=ra(),p=oa(),y=r.context,[j,C]=a.useState({}),[x,b]=a.useState("*"),[d,m]=a.useState(null),[H,z]=a.useState(!1),[I,v]=a.useState(!1),[G,B]=a.useState(!1);a.useEffect(()=>{c===0&&(x==="export"||x==="truncate")&&b("*")},[c]);const E={vertical:"top",horizontal:"right"},J=()=>{const o={};return i==null?{}:(Object.keys(i).map(g=>{i[g].tablesSelected.map(u=>{o[g]===void 0&&(o[g]={}),o[g][u]={status:null,typ:fe.TABLE}}),x==="drop"&&i[g].viewsSelected.map(u=>{o[g]===void 0&&(o[g]={}),o[g][u]={status:null,typ:fe.VIEW}})}),o)},f=(o,g,u)=>{const _={...j};g==="*"?Object.keys(_[o]).map(A=>_[o][A].status=u):_[o][g].status=u,C(_)},O=()=>{Object.keys(j).length>0&&Object.keys(j).map(o=>{window.document.getElementById(`pp-export-tables-${o}`).submit(),f(o,"*",!0)})},w=()=>{Object.keys(j).length>0&&Object.keys(j).map(o=>{Object.keys(j[o]).map(g=>{Fs(o,g,u=>{h.debug(u),(u==null?void 0:u.code)==="ok"&&(u==null?void 0:u.message)!==void 0?f(o,g,!0):f(o,g,!1)},u=>{console.error("error",o,g,u),f(o,g,!1)})})})},M=()=>{Object.keys(j).length>0&&Object.keys(j).map(o=>{Object.keys(j[o]).map(g=>{Bs(o,g,j[o][g].typ,u=>{h.debug(u),(u==null?void 0:u.code)==="ok"&&(u==null?void 0:u.message)!==void 0?f(o,g,!0):f(o,g,!1)},u=>{console.error("error",u),f(o,g,!1)})})})},R=o=>e.jsxs(_t,{sx:{"& th":{fontWeight:"bold",padding:"4px 6px"},"& td":{padding:"4px 6px",border:"none"}},children:[e.jsx(Mt,{children:e.jsxs(De,{children:[e.jsx(P,{children:"Database"}),e.jsx(P,{children:"Table | View"}),e.jsx(P,{children:"Status"})]})}),e.jsx(At,{children:Object.keys(o).map(g=>Object.keys(o[g]).map((u,_)=>{var A,K;return e.jsxs(De,{children:[e.jsx(P,{children:_===0?g:null}),e.jsx(P,{children:u}),e.jsxs(P,{children:[o[g][u]===null&&e.jsx(Us,{style:{display:"block",margin:"0 auto"}}),o[g][u].status===!0&&e.jsx(as,{color:(A=he)==null?void 0:A.palette.success.main,style:{display:"block",margin:"0 auto"}}),o[g][u].status===!1&&e.jsx(rs,{color:(K=he)==null?void 0:K.palette.error.main,style:{display:"block",margin:"0 auto"}})]})]},_)}))})]}),S=()=>e.jsx(l,{children:R(j)}),N=()=>{const o=J();return C(o),e.jsxs(l,{children:[R(o),(x==="truncate"||x==="drop")&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{marginTop:"20px"}}),e.jsx(l,{sx:{marginTop:"20px",marginBottom:"20px"},children:x==="drop"?e.jsx("span",{children:"Deletes views and tables with all data permanently."}):e.jsx("span",{children:"Deletes all data permanently."})}),e.jsx(l,{children:e.jsx("strong",{children:"This actions cannot be undone!"})}),e.jsxs(l,{children:["'",e.jsx("strong",{children:"NO"}),"' to stop, '",e.jsx("strong",{children:"YES"}),"' to continue."]}),e.jsxs(l,{sx:{marginTop:"20px",fontSize:"80%",display:"inline-grid",gridTemplateColumns:"auto auto",justifyContent:"space-between",alignItems:"center",gap:"5px"},children:[e.jsx(Js,{}),e.jsxs("span",{children:["Does not ",x," WordPress tables"]})]})]})]})};return s?e.jsxs(e.Fragment,{children:[e.jsx(ss,{className:"pp-bulk-actions-container",color:"inherit",position:"relative",elevation:4,sx:{margin:"0 0 5px 0"},children:e.jsxs(ns,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between"},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(ae,{variant:"standard",sx:{minWidth:200},children:e.jsxs(xt,{MenuProps:{id:"pp-select-menu"},value:x,onChange:o=>{b(o.target.value)},children:[e.jsx(ge,{value:"*",children:"Bulk actions"}),e.jsx(ge,{value:"export",disabled:c===0,children:qe.export}),e.jsx(ge,{value:"truncate",disabled:c===0,children:qe.truncate}),e.jsx(ge,{value:"drop",children:qe.drop})]})}),e.jsx(Me,{variant:"contained",onClick:()=>{x!=="*"?(m(N()),z(!0)):v(!0)},children:"Apply"})]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",gap:"12px",justifyContent:"space-between"},children:[e.jsx(Rt,{badgeContent:c,color:"info",anchorOrigin:E,children:e.jsx(es,{color:"action",size:20})}),e.jsx(Rt,{badgeContent:p,color:"info",anchorOrigin:E,children:e.jsx(ts,{color:"action",size:20})})]})]})}),x==="export"&&Object.keys(j).map(o=>e.jsxs("form",{id:"pp-export-tables-"+o,action:y.wp.home+"?action=wpda_export",method:"post",target:"_blank",children:[e.jsx("input",{type:"hidden",name:"type",value:"table"}),e.jsx("input",{type:"hidden",name:"wpdaschema_name",value:o}),Object.keys(j[o]).map(g=>e.jsx("input",{type:"hidden",name:"table_names[]",value:g},g)),e.jsx("input",{type:"hidden",name:"_wpnonce",value:y.wp.nonce.split("-")[0]})]},"pp-export-tables-"+o)),e.jsx(wt,{title:"Apply bulk action",message:"No bulk action selected",open:I,setOpen:v}),e.jsx(Pt,{title:qe[x],message:d,open:H,setOpen:z,onConfirm:()=>{switch(B(!0),x){case"export":O();break;case"truncate":w();break;case"drop":M()}}}),e.jsx(wt,{title:qe[x],message:S(),open:G,setOpen:B,onConfirm:()=>{Object.keys(j).map(o=>{t(Jt({dbs:o})),t(qt({dbs:o,isSelected:!1,search:""})),t(Yt({dbs:o})),t(Ut({dbs:o,isSelected:!1,search:""}))})}})]}):null},ca=({setDoImport:t})=>{var R,S,N;const s=mt(),r=kt(),i=s.context,[c,p]=a.useState(""),[y,j]=a.useState("");a.useEffect(()=>{if(r!=null&&Object.keys(r).length>0){const o=Object.keys(r).filter(g=>r[g].dbsType===q.WP);(o==null?void 0:o.length)>0&&p(o[0])}},[r]);const C=a.useRef(null),[x,b]=a.useState(null),d=(R=i==null?void 0:i.wp)!=null&&R.zip?".sql,.zip":".sql",m=(S=i==null?void 0:i.wp)!=null&&S.zip?"SQL and ZIP":"SQL",H=(N=i==null?void 0:i.wp)==null?void 0:N.upload,[z,I]=a.useState(!1),[v,G]=a.useState(null),[B,E]=a.useState(!1),[J,f]=a.useState(""),[O,w]=a.useState(null),M=o=>e.jsx(e.Fragment,{children:e.jsxs(_t,{sx:{"& th":{fontWeight:"bold",padding:"4px 6px"},"& td":{padding:"4px 6px",border:"none"}},children:[e.jsx(Mt,{children:e.jsxs(De,{children:[e.jsx(P,{children:"Import file"}),e.jsx(P,{children:"Message"}),e.jsx(P,{children:"Status"})]})}),e.jsx(At,{children:o.map(g=>Object.keys(g).map(u=>{var _,A;return e.jsxs(De,{children:[e.jsx(P,{sx:{verticalAlign:"text-top"},children:u}),e.jsxs(P,{sx:{verticalAlign:"text-top"},children:[g[u].msg,g[u].errors.map(K=>{var F;return e.jsx("ul",{style:{listStyle:"disc",padding:"0 40px"},children:e.jsx("li",{style:{color:(F=he)==null?void 0:F.palette.error.main},children:K})})})]}),e.jsx(P,{sx:{verticalAlign:"text-top"},children:g[u].status==="error"?e.jsx(rs,{color:(_=he)==null?void 0:_.palette.error.main,style:{display:"block",margin:"0 auto"}}):e.jsx(as,{color:(A=he)==null?void 0:A.palette.success.main,style:{display:"block",margin:"0 auto"}})})]},u)}))})]})});return e.jsxs(e.Fragment,{children:[e.jsxs(ut,{sx:{marginTop:0,marginBottom:"5px",padding:"20px 10px 20px 24px"},elevation:4,className:"pp-import-container",children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingRight:"8px !important",marginBottom:"20px"},children:[e.jsx(ve,{variant:"button",sx:{fontWeight:"bold"},children:"Import data and execute scripts"}),e.jsx(pt,{title:"Close",position:"bottom",children:e.jsx(pe,{onClick:()=>{C.current&&(C.current.value=""),j(""),t(!1)},size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(is,{})})})]}),e.jsxs(l,{sx:{display:"grid",gap:"10px",marginRight:"14px",marginBottom:"10px"},children:[e.jsxs(l,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"start",alignItems:"center",gap:"10px"},children:[e.jsx(l,{children:e.jsxs(ae,{sx:{minWidth:"300px"},children:[e.jsx(vt,{variant:"outlined",children:"Select destination database"}),e.jsx(xt,{MenuProps:{id:"pp-select-menu"},label:"Select destination database",value:c,onChange:o=>{p(o.target.value)},sx:{"& div.MuiSelect-select":{padding:"12px 14px"}},children:r!=null&&Object.keys(r).map(o=>{const g=r[o].dbsType===q.WP?o+" (WordPress database)":o;return e.jsx(ge,{value:o,children:g},o)})})]})}),e.jsx(l,{children:e.jsx("form",{children:e.jsxs(Me,{component:"label",variant:"outlined",startIcon:e.jsx(Ys,{}),sx:{padding:"10px 14px"},children:["Select file(s)",e.jsx(Te,{type:"file",slotProps:{input:{inputRef:C},htmlInput:{accept:d,multiple:!0}},onChange:o=>{const g=o.target.files;b(g);const u=Object.keys(g).map(_=>g[_].name).toString();j(u)},sx:{display:"none"}})]})})}),y!==""&&e.jsx(e.Fragment,{children:e.jsx(l,{children:e.jsx(Me,{component:"label",variant:"contained",startIcon:e.jsx(Qs,{}),sx:{padding:"10px 14px"},onClick:()=>{G(e.jsxs(l,{children:[e.jsxs(l,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:["Selected file(s): ",e.jsx("strong",{children:y})]}),e.jsxs(l,{children:["Selected database: ",e.jsx("strong",{children:c})]}),e.jsxs(l,{sx:{marginTop:"20px",fontSize:"80%"},children:[e.jsx("strong",{children:"NOTE"}),"Â  You can work on other tasks while your import is performed in the background."]})]})),I(!0)},children:"Import file(s)"})})})]}),y!==""&&e.jsxs(l,{sx:{marginTop:"20px",marginBottom:"10px",minWidth:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left",fontWeight:"bold"},children:["Selected file(s): ",y]}),e.jsxs("fieldset",{className:"pp-fieldset",style:{marginTop:"5px",minWidth:0},children:[e.jsx("legend",{children:"IMPORTANT"}),e.jsxs("ul",{style:{paddingLeft:"15px",listStyle:"disc",padding:"0 30px"},children:[e.jsx("li",{children:"Supports multiple file uploads simultaneously."}),e.jsxs("li",{children:["Server supports ",m," file types."]}),e.jsxs("li",{children:["Maximum supported file size on this server is ",H,"."]}),e.jsx("li",{children:"Add a ; and a new line character at the end of every SQL statement."})]})]})]})]}),e.jsx(Pt,{title:"Import selected file(s)?",message:v,open:z,setOpen:I,onConfirm:()=>{Ns(c,x,o=>{var g;if(o!=null&&o.message&&((g=o==null?void 0:o.context)!=null&&g.imported)&&Array.isArray(o.context.imported)){const u=o.context.imported;E(!0),f(o.message),w(M(u))}else de(te.contactSupport,{variant:"error"})},o=>{console.error("error",o),de(te.contactSupport,{variant:"error"})})}}),e.jsx(wt,{title:J,message:O,open:B,setOpen:E,onConfirm:()=>{j(""),t(!1)}})]})},Wt=a.lazy(()=>re(()=>import("./Alert-1.0.61-BDxavmCg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),da=({setDoBackup:t})=>{const s=In(),[r,i]=a.useState([]),[c,p]=a.useState("");h.debug("dbs",r);const[y,j]=a.useState([]);h.debug("tables",y);const[C,x]=a.useState({}),[b,d]=a.useState([]),[m,H]=a.useState({}),[z,I]=a.useState([]),[v,G]=a.useState(!1);h.debug("cron",C,m,z,v);const[B,E]=a.useState(!1),[J,f]=a.useState(!1),[O,w]=a.useState(""),[M,R]=a.useState(!1),[S,N]=a.useState({}),[o,g]=a.useState([]),[u,_]=a.useState(""),[A,K]=a.useState(""),[F,V]=a.useState(Tt()),[Y,W]=a.useState("nonrepeating"),[D,X]=a.useState(""),[be,ue]=a.useState(0),[se,ne]=a.useState(!1),[ye,xe]=a.useState(!1),[U,Se]=a.useState(!1),[Xe,Ze]=a.useState(!1),[we,gt]=a.useState("");a.useEffect(()=>{Be(),Fe()},[]),a.useEffect(()=>{S!=null&&S.dbs&&(S==null?void 0:S.dbs)!==""&&ft()},[S]),a.useEffect(()=>{const n=[];for(let T in C)if(C[T].wpda_run_scheduled_export){const L=C[T].wpda_run_scheduled_export;Object.keys(L).map(Z=>{var Ce,et,tt,Ke,Ve,We,$e,He;const ie=(tt=(et=(Ce=L[Z])==null?void 0:Ce.args)==null?void 0:et.args)==null?void 0:tt.name,oe=(We=(Ve=(Ke=L[Z])==null?void 0:Ke.args)==null?void 0:Ve.args)==null?void 0:We.params,le=($e=L[Z])==null?void 0:$e.interval,Ee=(He=L[Z])==null?void 0:He.schedule;n.push({dt:Tt.unix(Number(T)).format("YYYY-MM-DD HH:mm:ss"),name:ie,params:oe,interval:le,schedule:Ee})})}d(n)},[C]),a.useEffect(()=>{M&&(g([]),xe(!1),_(""),ne(!1),K(""),Se(!1),V(Tt()),W("nonrepeating"),X(""),ue(0))},[M]);const Be=async()=>{try{await It(dt.appUrlExportSchedules,{}).then(n=>{var T,L,Z,ie,oe,le,Ee;h.debug("response",n),((T=n==null?void 0:n.data)==null?void 0:T.code)==="ok"&&((Z=(L=n==null?void 0:n.data)==null?void 0:L.message)!=null&&Z.cron)&&((oe=(ie=n==null?void 0:n.data)==null?void 0:ie.message)==null?void 0:oe.mail)!==void 0&&((Ee=(le=n==null?void 0:n.data)==null?void 0:le.message)!=null&&Ee.schedules)?(x(n.data.message.cron),H(n.data.message.schedules),I(n.data.message.drives),G(n.data.message.mail),f(!1)):(console.error("Invalid response",n),w("Invalid response"),f(!0))}).catch(n=>{console.error(n),w(n.message),f(!0)})}catch(n){console.error(n),w("Error loading schedules"),f(!0)}},ht=async()=>{try{await It(dt.appUrlExportAdd,{name:u,params:{dbs:S.dbs,tbl:o.join(","),drv:A,eml:D,fkp:be},start:(F==null?void 0:F.unix())||0,interval:Y}).then(n=>{var T,L;h.debug("response",n),((T=n==null?void 0:n.data)==null?void 0:T.code)==="ok"?(de("Export successfully scheduled.",{variant:"success"}),Be(),R(!1)):(console.error(n),de(((L=n==null?void 0:n.data)==null?void 0:L.message)??"Invalid response",{variant:"error"}))}).catch(n=>{var T,L;console.error(n),de(((L=(T=n==null?void 0:n.response)==null?void 0:T.data)==null?void 0:L.message)??n.message,{variant:"error"})})}catch(n){console.error(n),de("Invalid response",{variant:"error"})}},Fe=()=>{Gt(n=>{h.debug("response",n),(n==null?void 0:n.code)==="ok"&&(n!=null&&n.data)&&Array.isArray(n.data)?(i(n.data),n.data.map(T=>{T.dbs_type==="wp"&&(p(T.dbs),N(T))}),E(!1)):(console.error("Invalid response",n),w("Invalid response"),E(!0))},n=>{console.error("error",n),w("Error loading databases"),E(!0)})},ft=()=>{Ht(S.dbs,function(n){h.debug("response",n),(n==null?void 0:n.code)==="ok"&&(n!=null&&n.data)&&Array.isArray(n.data)?(j(n.data),E(!1)):(w("Invalid response"),E(!0))},n=>{console.error("error",n),w("Error loading tables"),E(!0)})},jt=()=>e.jsxs("fieldset",{className:"pp-fieldset",children:[e.jsx("legend",{children:"Create new export"}),e.jsxs(l,{sx:{display:"grid",gap:"20px"},children:[e.jsxs(ae,{fullWidth:!0,sx:{marginTop:"8px"},children:[e.jsx(Vt,{options:r,value:S,onChange:(n,T)=>{N(T??"")},getOptionLabel:n=>c===n.dbs?n.dbs+" (WordPress database)":(n==null?void 0:n.dbs)??"",renderInput:n=>e.jsx(Te,{...n,label:"Select database *",variant:"outlined"}),sx:{width:"100%"}}),e.jsx(ct,{children:"Each database export requires a separate schedule."})]}),e.jsxs(ae,{fullWidth:!0,error:ye,children:[e.jsx(Vt,{multiple:!0,options:y,value:o,disableCloseOnSelect:!0,onChange:(n,T)=>{g(T),xe(!1),n.stopPropagation()},renderInput:n=>e.jsx(Te,{...n,label:"Select table(s) *",variant:"outlined",error:ye}),sx:{width:"100%"}}),e.jsx(ct,{children:"Supports selecting multiple tables."})]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:s.width<600?"1fr":"1fr 1fr",alignItems:"center",gap:"20px"},children:[e.jsx(Te,{type:"text",label:"Schedule Name",fullWidth:!0,required:!0,helperText:"Schedule name must be unique.",value:u,autoComplete:"off",error:se,onChange:n=>{_(n.target.value),ne(!1)}}),e.jsxs(ae,{fullWidth:!0,error:U,children:[e.jsx(vt,{variant:"outlined",children:"Drive *"}),e.jsxs(xt,{MenuProps:{id:"pp-select-menu"},label:"Drive *",value:A,error:U,onChange:n=>{K(n.target.value),Se(!1)},children:[...Object.keys(z).map(n=>e.jsx(ge,{value:z[n],children:z[n]},z[n]))]}),e.jsx(ct,{children:"Target location for saving export files."})]})]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:s.width<600?"1fr":"1fr 1fr",alignItems:"center",gap:"20px"},children:[e.jsx(wn,{dateAdapter:En,children:e.jsx(kn,{label:"Start date and time *",value:F,onChange:n=>{V(n)},slotProps:{textField:{helperText:"First execution time."}}})}),e.jsxs(ae,{fullWidth:!0,children:[e.jsx(vt,{variant:"outlined",children:"Recurrence *"}),e.jsxs(xt,{MenuProps:{id:"pp-select-menu"},label:"Recurrence *",value:Y,onChange:n=>{W(n.target.value)},children:[e.jsx(ge,{value:"nonrepeating",children:"Only Once (non-repeating)"},"nonrepeating"),...Object.keys(m).map(n=>e.jsx(ge,{value:n,children:m[n].display},n))]}),e.jsx(ct,{children:"How often the event should subsequently recur."})]})]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:s.width<600?"1fr":"1fr 1fr",gap:"20px"},children:[e.jsx(Te,{value:D,onChange:n=>{X(n.target.value)},label:"Email",placeholder:"example@domain.com",fullWidth:!0,disabled:!v,helperText:v?e.jsx(e.Fragment,{children:"Enter an email address to receive notifications."}):e.jsx(e.Fragment,{children:"Mail server not available. Configure in Settings > Mail."})}),e.jsx(l,{children:e.jsx(vn,{fullWidth:!0,customInput:Te,value:be,variant:"outlined",label:"Number of files to keep",onValueChange:({value:n})=>{Number(n)<0?ue(0):ue(Number(n))},onInvalid:n=>{n.preventDefault()},helperText:"Maximum number of export files to keep. Set to 0 to keep all files."})})]}),e.jsxs(l,{sx:{display:"flex",justifyContent:"flex-end",alignContent:"center",gap:"10px","& button":{width:"180px"}},children:[e.jsx(Me,{autoFocus:!0,fullWidth:!0,variant:"contained",onClick:n=>{let T=!1;o.length===0?(xe(!0),T=!0):xe(!1),u.trim()===""?(ne(!0),T=!0):ne(!1),A.trim()===""?(Se(!0),T=!0):Se(!1),!T&&(F==null?void 0:F.toString().toLowerCase())!=="invalid date"&&ht(),n.stopPropagation()},children:"Schedule"}),e.jsx(Me,{fullWidth:!0,variant:"outlined",onClick:n=>{R(!1),n.stopPropagation()},children:"Cancel"})]})]})]}),bt=()=>e.jsx(l,{sx:{"& thead th":{fontWeight:"bold"}},children:e.jsxs(_t,{children:[e.jsx(Mt,{children:e.jsxs(De,{children:[e.jsx(P,{}),e.jsx(P,{children:"Name"}),e.jsx(P,{children:"Scheduled"}),e.jsx(P,{children:"Time"}),e.jsx(P,{children:"Database"}),e.jsx(P,{children:"Tables"}),e.jsx(P,{children:"Drive"}),e.jsx(P,{children:"#Files"}),e.jsx(P,{children:"Email"})]})}),e.jsx(At,{children:b.map(n=>{var T,L,Z,ie,oe,le;return console.debug(n),e.jsxs(De,{children:[e.jsx(P,{sx:{width:"30px"},children:e.jsx(pt,{title:"Delete export",children:e.jsx(pe,{color:"error",onClick:()=>{gt(n.name),Ze(!0)},children:e.jsx(Zs,{})})})}),e.jsx(P,{children:n.name}),e.jsx(P,{children:(T=m==null?void 0:m[n.schedule])!=null&&T.display?m[n.schedule].display:n.schedule}),e.jsx(P,{children:n.dt}),e.jsx(P,{children:(L=n.params)==null?void 0:L.dbs}),e.jsx(P,{children:(Z=n.params)==null?void 0:Z.tbl}),e.jsx(P,{children:(ie=n.params)==null?void 0:ie.drv}),e.jsx(P,{children:(oe=n.params)==null?void 0:oe.fkp}),e.jsx(P,{children:(le=n.params)==null?void 0:le.eml})]},n.name)})})]})}),Ne=()=>{if(z.length===0)return e.jsx(a.Suspense,{children:e.jsx(Wt,{severity:"warning",message:"No active drives. Activate at least one drive in Settings > Drives.",close:!0})})},yt=()=>Object.keys(C).length===0?e.jsx(l,{children:"There are currently no scheduled exports."}):e.jsx(l,{children:bt()});return e.jsxs(e.Fragment,{children:[e.jsxs(ut,{sx:{marginTop:0,marginBottom:"5px",padding:"20px 10px 20px 24px"},elevation:4,children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingRight:"8px !important",marginBottom:"20px"},children:[e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",alignItems:"center",gap:"5px"},children:[e.jsx(ve,{variant:"button",sx:{fontWeight:"bold"},children:"Schedule exports"}),e.jsx(pt,{title:"Schedule new export",position:"bottom",children:e.jsx(pe,{onClick:()=>{R(!0)},color:"inherit",disabled:z.length===0,children:e.jsx(Xs,{})})})]}),e.jsx(pt,{title:"Close",position:"bottom",children:e.jsx(pe,{onClick:()=>{t(!1)},size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(is,{})})})]}),e.jsx(l,{sx:{display:"grid",gap:"10px",marginRight:"14px",marginBottom:"10px"},children:B||J?e.jsx(a.Suspense,{children:e.jsx(Wt,{severity:"error",message:O,close:!0})}):e.jsxs(e.Fragment,{children:[Ne(),M?jt():yt()]})})]}),Xe&&e.jsx(Pt,{title:"Delete job?",message:e.jsxs("div",{children:["Are you sure you want to delete job ",we,"?",e.jsx("br",{}),e.jsx("strong",{children:"This action cannot be undone!"})]}),open:Xe,setOpen:Ze,onConfirm:()=>{It(dt.appUrlExportDelete,{name:we}).then(n=>{var T;h.debug("response",n),((T=n==null?void 0:n.data)==null?void 0:T.code)==="ok"?(Be(),de("Export successfully deleted.",{variant:"success"})):(console.error(n),de("Invalid response",{variant:"error"}))}).catch(n=>{var T,L;console.error(n),de(((L=(T=n==null?void 0:n.response)==null?void 0:T.data)==null?void 0:L.message)??(n==null?void 0:n.message)??te.contactSupport,{variant:"error"})})}})]})},$t=a.lazy(()=>re(()=>import("./Alert-1.0.61-BDxavmCg.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),Dr=()=>{var S,N,o,g;const t=Q(),s=a.useRef(null),{search:r,setSearch:i}=Ye("ppExplorerSearch"),c=mt(),p=c.database,y=c.error,j=c.selected,C=c.dbsTypes,[x,b]=a.useState("");a.useEffect(()=>{window.ppActionEnableImport=(u=!0)=>{G(u)},window.ppActionEnableExport=(u=!0)=>{E(u)},d()},[]);const d=()=>{let u=[],_="";try{_=localStorage.getItem("ppExplorerSearchDbsTypes")}catch(A){h.debug(A)}_!=null&&_!==""?u=JSON.parse(_):u=[q.WP,q.LOCAL,q.REMOTE],Gt(A=>{const K=A==null?void 0:A.data;h.debug("response data",K);const F=[],V={};K.map(D=>{F.push({dbs:D.dbs,dbsType:D.dbs_type,pdsDbs:D.pds}),V[D.dbs]=!1}),H(V),F.sort((D,X)=>{var be,ue,se,ne;return((be=D==null?void 0:D.dbs)==null?void 0:be.toLocaleLowerCase())>((ue=X==null?void 0:X.dbs)==null?void 0:ue.toLocaleLowerCase())?1:((se=X==null?void 0:X.dbs)==null?void 0:se.toLocaleLowerCase())>((ne=D==null?void 0:D.dbs)==null?void 0:ne.toLocaleLowerCase())?-1:0}),h.debug(F),t(Ms({dbs:F,dbsTypes:u}));const Y={};K.map(D=>{Y[D.dbs]=D.dbs_type}),t(Ds({dbs:Y}));const W=A.context;h.debug("context",W),t(Ls({context:W}))},A=>{console.error("error",A),b(A??te.contactSupport)})},[m,H]=a.useState({}),[z,I]=a.useState(!0),[v,G]=a.useState(!1),[B,E]=a.useState(!1),J=()=>e.jsx(Ue,{title:"Import data and execute scripts",children:e.jsx(pe,{sx:{color:"inherit"},onClick:()=>{G(!v)},children:e.jsx(an,{})})}),f=()=>null,O=()=>e.jsx(pe,{onClick:()=>{R(M==="large"?"medium":M==="medium"?"small":"large")},sx:{color:"#fff"},children:M==="small"?e.jsx(tn,{}):M==="medium"?e.jsx(sn,{}):e.jsx(nn,{})});let w="";try{w=localStorage.getItem("ppDataExplorerDensity")}catch(u){h.debug(u)}const[M,R]=a.useState(w==="large"||w==="medium"?w:"small");return a.useEffect(()=>{try{localStorage.setItem("ppDataExplorerDensity",M)}catch(u){h.debug(u)}},[M]),x!==""?e.jsx(a.Suspense,{children:e.jsx($t,{severity:"error",message:x,close:!1})}):e.jsxs(l,{className:"pp-sub-container-explorer",sx:{width:"100%"},children:[e.jsx(ss,{className:"pp-explorer-header",elevation:4,position:"relative",sx:{margin:"0 0 5px 0"},children:e.jsx(ns,{sx:{display:"grid",gridTemplateColumns:"1fr auto",gap:"12px",justifyContent:"space-between",paddingRight:"0 !important"},children:((S=dt.appOrig)==null?void 0:S.appTarget)==="backend"?e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto auto",justifyContent:"end",alignItems:"center",gridGap:"10px"},children:[O(),e.jsx(l,{sx:{textAlign:"right"},children:"Search & Filter"}),e.jsx(Ae,{search:r,setSearch:i,addFilter:!0})]}):e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto 1fr",justifyContent:"space-between",alignItems:"center",gridGap:"10px"},children:[e.jsx(ve,{className:"pp-toolbar-title unselectable",variant:"subtitle1",color:(g=(o=(N=he)==null?void 0:N.palette)==null?void 0:o.primary)==null?void 0:g.contrastText,sx:{padding:0},children:"Data Explorer"}),e.jsxs(l,{children:[J(),f()]}),e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"end",alignItems:"center",gap:"10px"},children:[O(),e.jsx(Ae,{search:r,setSearch:i,addFilter:!0})]})]})})}),e.jsx(la,{}),v&&e.jsx(ca,{setDoImport:G}),B&&e.jsx(da,{setDoBackup:E}),p==null?e.jsx(l,{sx:{padding:"30px"},children:e.jsx(Os,{title:"Loading..."})}):e.jsxs(e.Fragment,{children:[y!==""&&e.jsx(ut,{sx:{marginBottom:"5px"},elevation:4,children:e.jsx(a.Suspense,{children:e.jsx($t,{severity:"error",message:y,close:!0,setClose:()=>{t(As({error:""}))}})})}),e.jsx(ut,{className:"pp-data-exporer",elevation:4,children:e.jsx(fn,{className:"pp-data-exporer-database-tree pp-density-"+M,"aria-label":"Data Explorer",sx:{"&:first-of-type":{borderTopLeftRadius:"4px",borderTopRightRadius:"4px",overflow:"hidden"},"&:last-of-type":{borderBottomLeftRadius:"4px",borderBottomRightRadius:"4px",overflow:"hidden"}},children:Object.keys(p).map(u=>{var A;if(C.includes(j[u])===!1||r!==""&&!Ie(u,r))return null;const _=((A=j[u])==null?void 0:A.toLocaleLowerCase())==="wp"?u+" (WordPress database)":u;return e.jsx(ee,{ref:s,slots:{expandIcon:zt,collapseIcon:z?zt:en},itemId:u,className:"pp-data-exporer-database-tree-item hide-details",onClickCapture:K=>{var F,V,Y,W;if((F=K.target.closest("li"))!=null&&F.classList.contains("pp-data-exporer-database-tree-item"))if((V=K.target.closest("li"))!=null&&V.classList.contains("hide-details")?((Y=K.target.closest("li"))==null||Y.classList.remove("hide-details"),I(!1)):((W=K.target.closest("li"))==null||W.classList.add("hide-details"),I(!0)),m[u])K.stopPropagation();else{const D=m;D[u]=!0,H(D)}},sx:{padding:"0","&.hide-details > ul":{visibility:"hidden",position:"fixed"}},label:e.jsxs(l,{sx:{display:"grid",gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",gap:"10px"},children:[e.jsx(Ks,{}),_]}),children:e.jsx(aa,{dbs:u,density:M})},u)})})})]})]})};export{Dr as default};
