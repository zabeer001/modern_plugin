const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CodeField-1.0.61-VcCGL0pj.js","./cm-1.0.61-D9ug3d5m.js","./redux-1.0.61-CrJ4jvTM.js","./vendor-1.0.61-CN03Eozo.js","./index-1.0.61-B7tjLD84.js","./Typography-1.0.61-Cg0Css-P.js","./lib-1.0.61-DoXQcMHD.js","./loglevel-1.0.61-BZ7XahX3.js","./lodash-1.0.61-C8OpKhUs.js","./moment-1.0.61-C5S46NFB.js","./ButtonBase-1.0.61-BqsrQx8o.js","./useEnhancedEffect-1.0.61-CX4-xj9Z.js","./ThemeProvider-1.0.61-4HOD8y6D.js","./Modal-1.0.61-DVFPMIPt.js","./notistack-1.0.61-0awN6uG4.js","./iconBase-1.0.61-C8saXaJ2.js","./cmJs-1.0.61-hWh8eEn6.js","./cmJson-1.0.61-BLURwXOE.js","./rehyperaw-1.0.61-AkovKNCK.js","./markdown-1.0.61-6nAzZWly.js","./cmHtml-1.0.61-ZqG0tpB4.js","./cmSql-1.0.61-CL9LoKgr.js","./Spinner-1.0.61-khi9zO7Q.js","./FormControlLabel-1.0.61-Bu2IQ4da.js","./Select-1.0.61-DmroHcG5.js","./Menu-1.0.61-D2OtRuzX.js","./createSvgIcon-1.0.61-DDgmYdEo.js","./Switch-1.0.61-CRYcdQMV.js","./SwitchBase-1.0.61-C2xa6JFZ.js","./DialogContent-1.0.61-Ws3r0VFj.js","./ConfirmDialog-1.0.61-BrxkBu_y.js","./cjs-1.0.61-D_0erLfe.js","./AdminTheme-1.0.61-D8bUxwpM.js"])))=>i.map(i=>d[i]);
import{_ as N}from"./cmJson-1.0.61-BLURwXOE.js";import{j as a}from"./cm-1.0.61-D9ug3d5m.js";import{r as p}from"./redux-1.0.61-CrJ4jvTM.js";import{l as x,o as q}from"./lib-1.0.61-DoXQcMHD.js";import{a as g}from"./hooks-1.0.61-Bklk-gZu.js";import{l as H,u,k as _,f as b,g as E}from"./StartQueryBuilder-1.0.61-DpIXLFtV.js";import{e as I,u as j,a as B}from"./QueryBuilder-1.0.61-CHDCBAvB.js";import{u as S}from"./MainQueryBuilder-1.0.61-CAqlR54P.js";import{e as l}from"./notistack-1.0.61-0awN6uG4.js";import{B as k}from"./Spinner-1.0.61-khi9zO7Q.js";import"./vendor-1.0.61-CN03Eozo.js";import"./rehyperaw-1.0.61-AkovKNCK.js";import"./markdown-1.0.61-6nAzZWly.js";import"./loglevel-1.0.61-BZ7XahX3.js";import"./lodash-1.0.61-C8OpKhUs.js";import"./moment-1.0.61-C5S46NFB.js";import"./useViewHeight-1.0.61-5KT6Wm-M.js";import"./index-1.0.61-B7tjLD84.js";import"./Typography-1.0.61-Cg0Css-P.js";import"./ButtonBase-1.0.61-BqsrQx8o.js";import"./useEnhancedEffect-1.0.61-CX4-xj9Z.js";import"./ThemeProvider-1.0.61-4HOD8y6D.js";import"./Modal-1.0.61-DVFPMIPt.js";import"./iconBase-1.0.61-C8saXaJ2.js";import"./ConfirmDialog-1.0.61-BrxkBu_y.js";import"./cjs-1.0.61-D_0erLfe.js";import"./AdminTheme-1.0.61-D8bUxwpM.js";import"./DialogContent-1.0.61-Ws3r0VFj.js";import"./RestApi-1.0.61-DdTZ_pIc.js";import"./TabPanel-1.0.61-BtYzUOMH.js";import"./InputAdornment-1.0.61-23wkGu1k.js";import"./getThemeProps-1.0.61-OfsHdeDz.js";import"./Select-1.0.61-DmroHcG5.js";import"./Menu-1.0.61-D2OtRuzX.js";import"./createSvgIcon-1.0.61-DDgmYdEo.js";import"./index-1.0.61-Cpig8940.js";import"./SanitizeComponent-1.0.61-jz3CtJfW.js";import"./dompurify-1.0.61-DhD2mIk-.js";import"./TextField-1.0.61-DyvT2G_W.js";import"./FormControlLabel-1.0.61-Bu2IQ4da.js";import"./Checkbox-1.0.61-BlN5bjuH.js";import"./SwitchBase-1.0.61-C2xa6JFZ.js";import"./Divider-1.0.61-C8DX248W.js";import"./MenuItem-1.0.61-Bmr1xWyp.js";import"./TabList-1.0.61-CK8HCF5k.js";import"./Tabs-1.0.61-Bhozjonn.js";import"./Switch-1.0.61-CRYcdQMV.js";/* empty css                    */import"./ActionsExplorer-1.0.61-Bj7vTxIj.js";import"./DatabaseTypeEnum-1.0.61-DeJfpW1u.js";const C=()=>{const e=g(),r=S();return t=>{const s=r.queries[r.tabIndex];r.sqlSchemas[s==null?void 0:s.schemaName]===void 0&&I(t,i=>{x.debug(i),(i==null?void 0:i.code)==="ok"&&e(H({sqlSchemaName:t,sqlSchema:i==null?void 0:i.data}))},i=>{console.error(i)})}},R=p.lazy(()=>N(()=>import("./CodeField-1.0.61-VcCGL0pj.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url)),Be=({queryKey:e,query:r,fullScreen:f})=>{const t=g(),s=S(),i=C(),{getQueryKey:Q}=j(),[d,h]=p.useState(q(r.query)),n=p.useRef();n.current=d,p.useEffect(()=>{s.showSqlHints&&i(s.queries[e].schemaName)},[s.showSqlHints,s.queries[e].schemaName]),p.useEffect(()=>{s.copyQuery&&(h(s.copyQuery),t(u({queryKey:e,query:{access:r.access,queryName:r.queryName,query:s.copyQuery,schemaName:r.schemaName,isVisual:r.isVisual,isInserting:r.isInserting,params:r.params}})),t(_({copyQuery:void 0})))},[s.copyQuery]);const v=()=>{var c;if(n.current){const o=b.getSelectors().selectQueryBuilder(E.getState().sql);(c=o==null?void 0:o.queries)!=null&&c[e]&&B(o.queries[e].access,o.queries[e].schemaName,o.queries[e].queryName,q(n.current),!1,"",o.queries[e].isInserting,o.queries[e].params,m=>{x.debug(m),(m==null?void 0:m.code)==="ok"&&(t(u({queryKey:e,query:{...o.queries[e],isInserting:void 0},isUpdated:!1})),l("Query succesfully saved",{variant:"success"}))},m=>{console.error(m),l(m,{variant:"error"})})}else l("Invalid code reference",{variant:"error"})};return a.jsx(k,{className:"pp-sql-query-builder-editor",children:a.jsx(p.Suspense,{children:a.jsx(R,{code:d,setCode:c=>{h(c),t(u({queryKey:e,query:{...r,query:c}}))},dialogTitle:Q(e),extension:"sql",sqlSchema:s.showSqlHints?s.sqlSchemas[s.queries[e].schemaName]:void 0,initialHeight:f?"calc(((calc(var(--ppViewHeight, 1vh) * 100) - 69px - 48px - 69px - 48px - 5px) / 2) - 28px - 5px)":"270px",saveCode:v})})})};export{Be as default};
